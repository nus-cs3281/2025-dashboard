[{"path":"src/main/java/teammates/ui/webapi/DeleteAccountAction.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"-"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"-"},"content":"/**","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"-"},"content":" * Action: deletes an existing account (either student or instructor).","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"-"},"content":" */","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"mingyang143"},"content":"public class DeleteAccountAction extends AdminOnlyAction {","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"-"},"content":"    public JsonResult execute() {","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"-"},"content":"        String googleId \u003d getNonNullRequestParamValue(Const.ParamsNames.INSTRUCTOR_ID);","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"-"},"content":"        // deleteAccountCascade is needed for datastore for dual DB","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"-"},"content":"        // as it deletes the student and instructor entities which are not yet migrated","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"-"},"content":"        logic.deleteAccountCascade(googleId);","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"-"},"content":"        sqlLogic.deleteAccountCascade(googleId);","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"-"},"content":"        return new JsonResult(\"Account is successfully deleted.\");","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"-"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":1,"-":21}},{"path":"src/main/java/teammates/ui/webapi/DeleteAccountRequestAction.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"-"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"-"},"content":"import teammates.storage.sqlentity.AccountRequest;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"-"},"content":"/**","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"-"},"content":" * Deletes an existing account request.","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"-"},"content":" */","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"peasantbird"},"content":"public class DeleteAccountRequestAction extends AdminOnlyAction {","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"-"},"content":"    public JsonResult execute() throws InvalidOperationException {","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"-"},"content":"        UUID id \u003d getUuidRequestParamValue(Const.ParamsNames.ACCOUNT_REQUEST_ID);","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"-"},"content":"        AccountRequest toDelete \u003d sqlLogic.getAccountRequest(id);","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"-"},"content":"        if (toDelete !\u003d null \u0026\u0026 toDelete.getRegisteredAt() !\u003d null) {","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"-"},"content":"            // instructor is already registered and cannot be deleted","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"-"},"content":"            throw new InvalidOperationException(\"Account request of a registered instructor cannot be deleted.\");","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"-"},"content":"        sqlLogic.deleteAccountRequest(id);","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"-"},"content":"        return new JsonResult(\"Account request successfully deleted.\");","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"-"},"content":"}","isFullCredit":false}],"authorContributionMap":{"peasantbird":1,"-":28}},{"path":"src/main/java/teammates/ui/webapi/GetAccountsAction.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.util.ArrayList;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"-"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"-"},"content":"import teammates.common.datatransfer.attributes.AccountAttributes;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"-"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"-"},"content":"import teammates.common.util.SanitizationHelper;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"-"},"content":"import teammates.storage.sqlentity.Account;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"-"},"content":"import teammates.ui.output.AccountData;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"-"},"content":"import teammates.ui.output.AccountsData;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"-"},"content":"/**","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"-"},"content":" * Gets all accounts with the given email.","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"-"},"content":" */","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"mingyang143"},"content":"public class GetAccountsAction extends AdminOnlyAction {","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"-"},"content":"    public JsonResult execute() {","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"-"},"content":"        String email \u003d getNonNullRequestParamValue(Const.ParamsNames.USER_EMAIL);","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"-"},"content":"        email \u003d SanitizationHelper.sanitizeEmail(email);","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"-"},"content":"        List\u003cAccountAttributes\u003e premigratedAccounts \u003d logic.getAccountsForEmail(email);","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"-"},"content":"        List\u003cAccount\u003e migratedAccounts \u003d sqlLogic.getAccountsForEmail(email);","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"-"},"content":"        List\u003cAccountData\u003e accounts \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"-"},"content":"        for (AccountAttributes accountAttribute : premigratedAccounts) {","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"-"},"content":"            accounts.add(new AccountData(accountAttribute));","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"-"},"content":"        for (Account account : migratedAccounts) {","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"-"},"content":"            accounts.add(new AccountData(account));","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"-"},"content":"        return new JsonResult(new AccountsData(accounts));","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"-"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":1,"-":37}},{"path":"src/main/java/teammates/ui/webapi/GetTimeZonesAction.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"-"},"content":"import java.time.ZoneId;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"-"},"content":"import java.time.zone.ZoneRulesProvider;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"-"},"content":"import java.util.Map;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"-"},"content":"import java.util.TreeMap;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"-"},"content":"import teammates.ui.output.TimeZonesData;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"-"},"content":"/**","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"-"},"content":" * Action: get supported time zones.","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"-"},"content":" */","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"public class GetTimeZonesAction extends Action {","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"-"},"content":"    AuthType getMinAuthLevel() {","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"-"},"content":"        return AuthType.LOGGED_IN;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"-"},"content":"    void checkSpecificAccessControl() throws UnauthorizedAccessException {","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"-"},"content":"        if (!userInfo.isMaintainer \u0026\u0026 !userInfo.isAdmin) {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"-"},"content":"            throw new UnauthorizedAccessException(\"Only Maintainers or Admin are allowed to access this resource.\");","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"-"},"content":"    public JsonResult execute() {","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"-"},"content":"        String tzVersion \u003d ZoneRulesProvider.getVersions(\"UTC\").firstKey();","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"-"},"content":"        Instant now \u003d Instant.now();","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"-"},"content":"        Map\u003cString, Integer\u003e tzOffsets \u003d new TreeMap\u003c\u003e();","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"-"},"content":"        for (String tz : ZoneId.getAvailableZoneIds()) {","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"-"},"content":"            if (!tz.contains(\"SystemV\")) {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"-"},"content":"                int offset \u003d ZoneId.of(tz).getRules().getOffset(now).getTotalSeconds();","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"-"},"content":"                tzOffsets.put(tz, offset);","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"-"},"content":"            }","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"-"},"content":"        TimeZonesData output \u003d new TimeZonesData(tzVersion, tzOffsets);","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"-"},"content":"        return new JsonResult(output);","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"-"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":1,"-":41}},{"path":"src/main/java/teammates/ui/webapi/GetUsageStatisticsAction.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.time.Duration;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"-"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"-"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"-"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"-"},"content":"import teammates.storage.sqlentity.UsageStatistics;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"-"},"content":"import teammates.ui.output.UsageStatisticsRangeData;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"-"},"content":"/**","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"-"},"content":" * Gets usage statistics for a specified time period.","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"-"},"content":" */","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"public class GetUsageStatisticsAction extends Action {","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"-"},"content":"    private static final Duration MAX_SEARCH_WINDOW \u003d Duration.ofDays(184L); // covering six whole months","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"-"},"content":"    AuthType getMinAuthLevel() {","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"-"},"content":"        return AuthType.LOGGED_IN;","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"-"},"content":"    void checkSpecificAccessControl() throws UnauthorizedAccessException {","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"-"},"content":"        if (!userInfo.isMaintainer \u0026\u0026 !userInfo.isAdmin) {","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"-"},"content":"            throw new UnauthorizedAccessException(\"Only Maintainers or Admin are allowed to access this resource.\");","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"-"},"content":"    @Override","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"-"},"content":"    public JsonResult execute() {","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"-"},"content":"        String startTimeString \u003d getNonNullRequestParamValue(Const.ParamsNames.QUERY_LOGS_STARTTIME);","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"-"},"content":"        long startTime;","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"-"},"content":"        try {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"-"},"content":"            startTime \u003d Long.parseLong(startTimeString);","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"-"},"content":"        } catch (NumberFormatException e) {","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"-"},"content":"            throw new InvalidHttpParameterException(\"Invalid startTime parameter\", e);","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"-"},"content":"        String endTimeString \u003d getNonNullRequestParamValue(Const.ParamsNames.QUERY_LOGS_ENDTIME);","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"-"},"content":"        long endTime;","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"-"},"content":"        try {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"-"},"content":"            endTime \u003d Long.parseLong(endTimeString);","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"-"},"content":"        } catch (NumberFormatException e) {","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"-"},"content":"            throw new InvalidHttpParameterException(\"Invalid endTime parameter\", e);","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"-"},"content":"        if (startTime \u003e\u003d endTime) {","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"-"},"content":"            throw new InvalidHttpParameterException(\"The end time should be after the start time.\");","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"-"},"content":"        if (endTime \u003e Instant.now().toEpochMilli()) {","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"-"},"content":"            throw new InvalidHttpParameterException(\"The end time must not exceed the current time.\");","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"-"},"content":"        if (endTime - startTime \u003e MAX_SEARCH_WINDOW.toMillis()) {","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"-"},"content":"            throw new InvalidHttpParameterException(\"The search window must not exceed \"","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"-"},"content":"                    + MAX_SEARCH_WINDOW.toDays() + \" full days.\");","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"-"},"content":"        }","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"-"},"content":"        List\u003cUsageStatistics\u003e usageStatisticsInRange \u003d","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"-"},"content":"                sqlLogic.getUsageStatisticsForTimeRange(Instant.ofEpochMilli(startTime), Instant.ofEpochMilli(endTime));","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"-"},"content":"        UsageStatisticsRangeData output \u003d new UsageStatisticsRangeData(usageStatisticsInRange);","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"-"},"content":"        return new JsonResult(output);","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"-"},"content":"    }","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"-"},"content":"","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"-"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":1,"-":66}},{"path":"src/test/java/teammates/sqlui/webapi/CreateNotificationActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.ArgumentMatchers.isA;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.datatransfer.NotificationStyle;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.datatransfer.NotificationTargetUser;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.exception.InvalidParametersException;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.NotificationData;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.request.InvalidHttpRequestBodyException;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.request.NotificationCreateRequest;","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.CreateNotificationAction;","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link CreateNotificationAction}.","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"public class CreateNotificationActionTest extends BaseActionTest\u003cCreateNotificationAction\u003e {","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"    private static final String GOOGLE_ID \u003d \"user-googleId\";","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"    private static final String INVALID_TITLE \u003d \"\";","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"    NotificationCreateRequest testReq;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    private Notification testNotification;","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATION;","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"        return POST;","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"        testNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_addNotification_success() throws Exception {","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"        long startTime \u003d testNotification.getStartTime().toEpochMilli();","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"        long endTime \u003d testNotification.getEndTime().toEpochMilli();","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"        NotificationStyle style \u003d testNotification.getStyle();","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"        NotificationTargetUser targetUser \u003d testNotification.getTargetUser();","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"        String title \u003d testNotification.getTitle();","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"        String message \u003d testNotification.getMessage();","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.createNotification(isA(Notification.class))).thenAnswer(invocation -\u003e invocation.getArgument(0));","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"        NotificationCreateRequest req \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"        CreateNotificationAction action \u003d getAction(req);","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"        NotificationData res \u003d (NotificationData) action.execute().getOutput();","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getNotification(UUID.fromString(res.getNotificationId()))).thenReturn(testNotification);","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"        Notification createdNotification \u003d mockLogic.getNotification(UUID.fromString(res.getNotificationId()));","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"        // check that notification returned has same properties as notification created","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getStartTime().toEpochMilli(), res.getStartTimestamp());","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getEndTime().toEpochMilli(), res.getEndTimestamp());","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getStyle(), res.getStyle());","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getTargetUser(), res.getTargetUser());","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getTitle(), res.getTitle());","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(createdNotification.getMessage(), res.getMessage());","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"        // check DB correctly processed request","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(startTime, createdNotification.getStartTime().toEpochMilli());","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(endTime, createdNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(style, createdNotification.getStyle());","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(targetUser, createdNotification.getTargetUser());","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(title, createdNotification.getTitle());","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(message, createdNotification.getMessage());","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_instructor_cannotAccess() {","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(GOOGLE_ID);","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidStyle_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setStyle(null);","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification style cannot be null\", ex.getMessage());","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidTargetUser_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setTargetUser(null);","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification target user cannot be null\", ex.getMessage());","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidTitle_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setTitle(null);","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification title cannot be null\", ex.getMessage());","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidMessage_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setMessage(null);","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification message cannot be null\", ex.getMessage());","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_negativeStartTimestamp_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setStartTimestamp(-1);","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Start timestamp should be greater than zero\", ex.getMessage());","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_negativeEndTimestamp_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setEndTimestamp(-1);","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"End timestamp should be greater than zero\", ex.getMessage());","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidParameter_throwsInvalidHttpParameterException() throws Exception {","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"InfinityTwo"},"content":"        testReq \u003d getTypicalCreateRequest();","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"InfinityTwo"},"content":"        testReq.setTitle(INVALID_TITLE);","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.createNotification(any())).thenThrow(new InvalidParametersException(\"Invalid title\"));","isFullCredit":false},{"lineNumber":174,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpRequestBodyException ex \u003d verifyHttpRequestBodyFailure(testReq);","isFullCredit":false},{"lineNumber":175,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":176,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Invalid title\", ex.getMessage());","isFullCredit":false},{"lineNumber":177,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":178,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":179,"author":{"gitId":"InfinityTwo"},"content":"    private NotificationCreateRequest getTypicalCreateRequest() {","isFullCredit":false},{"lineNumber":180,"author":{"gitId":"InfinityTwo"},"content":"        NotificationCreateRequest req \u003d new NotificationCreateRequest();","isFullCredit":false},{"lineNumber":181,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":182,"author":{"gitId":"InfinityTwo"},"content":"        req.setStartTimestamp(testNotification.getStartTime().toEpochMilli());","isFullCredit":false},{"lineNumber":183,"author":{"gitId":"InfinityTwo"},"content":"        req.setEndTimestamp(testNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":184,"author":{"gitId":"InfinityTwo"},"content":"        req.setStyle(testNotification.getStyle());","isFullCredit":false},{"lineNumber":185,"author":{"gitId":"InfinityTwo"},"content":"        req.setTargetUser(testNotification.getTargetUser());","isFullCredit":false},{"lineNumber":186,"author":{"gitId":"InfinityTwo"},"content":"        req.setTitle(testNotification.getTitle());","isFullCredit":false},{"lineNumber":187,"author":{"gitId":"InfinityTwo"},"content":"        req.setMessage(testNotification.getMessage());","isFullCredit":false},{"lineNumber":188,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":189,"author":{"gitId":"InfinityTwo"},"content":"        return req;","isFullCredit":false},{"lineNumber":190,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":191,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":192,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":192}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteAccountActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"mingyang143"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"mingyang143"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"mingyang143"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Account;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.webapi.DeleteAccountAction;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"mingyang143"},"content":"/**","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"mingyang143"},"content":" * SUT: {@link DeleteAccountAction}.","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"mingyang143"},"content":" */","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"mingyang143"},"content":"public class DeleteAccountActionTest extends BaseActionTest\u003cDeleteAccountAction\u003e {","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"mingyang143"},"content":"    String googleId \u003d \"user-googleId\";","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"mingyang143"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"mingyang143"},"content":"        return Const.ResourceURIs.ACCOUNT;","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"mingyang143"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"mingyang143"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"mingyang143"},"content":"    protected void textExecute_nullParams_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, null,","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"mingyang143"},"content":"    protected void testExecute_nonNullParams_success() {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"mingyang143"},"content":"        Course stubCourse \u003d new Course(\"course-id\", \"name\", Const.DEFAULT_TIME_ZONE, \"institute\");","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"mingyang143"},"content":"        Account stubAccount \u003d new Account(googleId, \"name\", \"instructoremail@tm.tmt\");","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d new Instructor(stubCourse, \"name\", \"instructoremail@tm.tmt\",","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"mingyang143"},"content":"                false, \"\", null, new InstructorPrivileges());","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"mingyang143"},"content":"        instructor.setAccount(stubAccount);","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"mingyang143"},"content":"        DeleteAccountAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"mingyang143"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"mingyang143"},"content":"        assertEquals(\"Account is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"mingyang143"},"content":"        verify(mockLogic, times(1)).deleteAccountCascade(googleId);","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"mingyang143"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":55}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteAccountRequestActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"peasantbird"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"peasantbird"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"peasantbird"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"peasantbird"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"peasantbird"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"peasantbird"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"peasantbird"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"peasantbird"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"peasantbird"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"peasantbird"},"content":"import teammates.storage.sqlentity.AccountRequest;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"peasantbird"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"peasantbird"},"content":"import teammates.ui.webapi.DeleteAccountRequestAction;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"peasantbird"},"content":"import teammates.ui.webapi.InvalidOperationException;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"peasantbird"},"content":"/**","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"peasantbird"},"content":" * SUT: {@link DeleteAccountRequestAction}.","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"peasantbird"},"content":" */","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"peasantbird"},"content":"public class DeleteAccountRequestActionTest extends BaseActionTest\u003cDeleteAccountRequestAction\u003e {","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"peasantbird"},"content":"    private AccountRequest accountRequest;","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"peasantbird"},"content":"    @Override","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"peasantbird"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"peasantbird"},"content":"        return Const.ResourceURIs.ACCOUNT_REQUEST;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"peasantbird"},"content":"    @Override","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"peasantbird"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"peasantbird"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"peasantbird"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"peasantbird"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"peasantbird"},"content":"        accountRequest \u003d getTypicalAccountRequest();","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"peasantbird"},"content":"    void testExecute_existingAccountRequest_success() {","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"peasantbird"},"content":"        UUID id \u003d accountRequest.getId();","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"peasantbird"},"content":"        when(mockLogic.getAccountRequest(id)).thenReturn(accountRequest);","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, id.toString(),","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"peasantbird"},"content":"        DeleteAccountRequestAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"peasantbird"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"peasantbird"},"content":"        assertEquals(\"Account request successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"peasantbird"},"content":"        verify(mockLogic, times(1)).deleteAccountRequest(id);","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"peasantbird"},"content":"    void testExecute_registeredInstructor_throwsInvalidOperationException() {","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"peasantbird"},"content":"        accountRequest.setRegisteredAt(Instant.now());","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"peasantbird"},"content":"        UUID id \u003d accountRequest.getId();","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"peasantbird"},"content":"        when(mockLogic.getAccountRequest(id)).thenReturn(accountRequest);","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, id.toString(),","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"peasantbird"},"content":"        InvalidOperationException ex \u003d verifyInvalidOperation(params);","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"peasantbird"},"content":"        assertEquals(\"Account request of a registered instructor cannot be deleted.\", ex.getMessage());","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"peasantbird"},"content":"    void testExecute_nonExistingAccountRequest_failSilently() {","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"peasantbird"},"content":"        accountRequest \u003d null;","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"peasantbird"},"content":"        UUID id \u003d UUID.fromString(\"11110000-0000-0000-0000-000000000000\");","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"peasantbird"},"content":"        when(mockLogic.getAccountRequest(id)).thenReturn(accountRequest);","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, id.toString(),","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"peasantbird"},"content":"        DeleteAccountRequestAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"peasantbird"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"peasantbird"},"content":"        assertEquals(\"Account request successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"peasantbird"},"content":"    void testExecute_missingAccountRequestId_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, null,","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"peasantbird"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"peasantbird"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"peasantbird"},"content":"        UUID id \u003d accountRequest.getId();","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"peasantbird"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"peasantbird"},"content":"        when(mockLogic.getAccountRequest(id)).thenReturn(accountRequest);","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, id.toString(),","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"peasantbird"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"peasantbird"},"content":"    @Test","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"peasantbird"},"content":"    void testSpecificAccessControl_notAdmin_cannotAccess() {","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"peasantbird"},"content":"        UUID id \u003d accountRequest.getId();","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"peasantbird"},"content":"        when(mockLogic.getAccountRequest(id)).thenReturn(accountRequest);","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"peasantbird"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"peasantbird"},"content":"                Const.ParamsNames.ACCOUNT_REQUEST_ID, id.toString(),","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"peasantbird"},"content":"        };","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"peasantbird"},"content":"        loginAsUnregistered(\"unregistered\");","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"peasantbird"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"peasantbird"},"content":"        loginAsStudent(\"student\");","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"peasantbird"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"peasantbird"},"content":"        loginAsInstructor(\"instructor\");","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"peasantbird"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"peasantbird"},"content":"","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"peasantbird"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"peasantbird"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"peasantbird"},"content":"    }","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"peasantbird"},"content":"}","isFullCredit":false}],"authorContributionMap":{"peasantbird":135}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteFeedbackQuestionActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"BunnyHoppp"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"BunnyHoppp"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"BunnyHoppp"},"content":"import static teammates.common.util.Const.InstructorPermissionRoleNames.INSTRUCTOR_PERMISSION_ROLE_OBSERVER;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"BunnyHoppp"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"BunnyHoppp"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"BunnyHoppp"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.storage.sqlentity.FeedbackQuestion;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.storage.sqlentity.FeedbackSession;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"BunnyHoppp"},"content":"import teammates.ui.webapi.DeleteFeedbackQuestionAction;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"BunnyHoppp"},"content":"/**","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"BunnyHoppp"},"content":" * SUT: {@link DeleteFeedbackQuestionAction}.","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"BunnyHoppp"},"content":" */","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"BunnyHoppp"},"content":"public class DeleteFeedbackQuestionActionTest extends BaseActionTest\u003cDeleteFeedbackQuestionAction\u003e {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"BunnyHoppp"},"content":"    private Instructor typicalInstructor;","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"BunnyHoppp"},"content":"    private Course typicalCourse;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"BunnyHoppp"},"content":"    private FeedbackSession typicalFeedbackSession;","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"BunnyHoppp"},"content":"    private FeedbackQuestion typicalFeedbackQuestion;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"BunnyHoppp"},"content":"    @Override","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"BunnyHoppp"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"BunnyHoppp"},"content":"        return Const.ResourceURIs.QUESTION;","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"BunnyHoppp"},"content":"    @Override","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"BunnyHoppp"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"BunnyHoppp"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"BunnyHoppp"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"BunnyHoppp"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"BunnyHoppp"},"content":"        typicalInstructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"BunnyHoppp"},"content":"        typicalCourse \u003d typicalInstructor.getCourse();","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"BunnyHoppp"},"content":"        typicalFeedbackSession \u003d getTypicalFeedbackSessionForCourse(typicalCourse);","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"BunnyHoppp"},"content":"        typicalFeedbackQuestion \u003d getTypicalFeedbackQuestionForSession(typicalFeedbackSession);","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"BunnyHoppp"},"content":"    void testExecute_feedbackQuestionExists_success() {","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackQuestion(typicalFeedbackQuestion.getId())).thenReturn(typicalFeedbackQuestion);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"BunnyHoppp"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, typicalFeedbackQuestion.getId().toString(),","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"BunnyHoppp"},"content":"        DeleteFeedbackQuestionAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"BunnyHoppp"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"BunnyHoppp"},"content":"        assertEquals(\"Feedback question deleted!\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"BunnyHoppp"},"content":"    void testExecute_feedbackQuestionDoesNotExist_failSilently() {","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"BunnyHoppp"},"content":"        UUID nonexistentQuestionId \u003d UUID.fromString(\"11110000-0000-0000-0000-000000000000\");","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackQuestion(nonexistentQuestionId)).thenReturn(null);","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"BunnyHoppp"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, nonexistentQuestionId.toString(),","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"BunnyHoppp"},"content":"        DeleteFeedbackQuestionAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"BunnyHoppp"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"BunnyHoppp"},"content":"        assertEquals(\"Feedback question deleted!\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"BunnyHoppp"},"content":"    void testExecute_missingFeedbackQuestionId_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"BunnyHoppp"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, null,","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"BunnyHoppp"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"BunnyHoppp"},"content":"    void testSpecificAccessControl_nonExistentFeedbackQuestion_cannotAccess() {","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackQuestion(typicalFeedbackQuestion.getId())).thenReturn(null);","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"BunnyHoppp"},"content":"        String[] submissionParams \u003d {","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, typicalFeedbackQuestion.getId().toString(),","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"BunnyHoppp"},"content":"        verifyCannotAccess(submissionParams);","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"BunnyHoppp"},"content":"    void testSpecificAccessControl_withModifySessionPrivilege_canAccess() {","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackQuestion(typicalFeedbackQuestion.getId())).thenReturn(typicalFeedbackQuestion);","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackSession(typicalFeedbackQuestion.getFeedbackSession().getName(),","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"BunnyHoppp"},"content":"                typicalFeedbackQuestion.getCourseId())).thenReturn(typicalFeedbackSession);","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getInstructorByGoogleId(typicalCourse.getId(), typicalInstructor.getGoogleId()))","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"BunnyHoppp"},"content":"                .thenReturn(typicalInstructor);","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"BunnyHoppp"},"content":"        String[] submissionParams \u003d {","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, typicalFeedbackQuestion.getId().toString(),","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"BunnyHoppp"},"content":"        loginAsInstructor(typicalInstructor.getGoogleId());","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"BunnyHoppp"},"content":"        verifyCanAccess(submissionParams);","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"BunnyHoppp"},"content":"    @Test","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"BunnyHoppp"},"content":"    void testSpecificAccessControl_withoutModifySessionPrivilege_cannotAccess() {","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"BunnyHoppp"},"content":"        // create instructor without modify session privilege","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"BunnyHoppp"},"content":"        Instructor instructorWithoutAccess \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"BunnyHoppp"},"content":"        instructorWithoutAccess.setPrivileges(new InstructorPrivileges(INSTRUCTOR_PERMISSION_ROLE_OBSERVER));","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackQuestion(typicalFeedbackQuestion.getId())).thenReturn(typicalFeedbackQuestion);","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getFeedbackSession(typicalFeedbackQuestion.getFeedbackSession().getName(),","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"BunnyHoppp"},"content":"                typicalFeedbackQuestion.getCourseId())).thenReturn(typicalFeedbackSession);","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"BunnyHoppp"},"content":"        when(mockLogic.getInstructorByGoogleId(typicalCourse.getId(), instructorWithoutAccess.getGoogleId()))","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"BunnyHoppp"},"content":"                .thenReturn(instructorWithoutAccess);","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"BunnyHoppp"},"content":"        String[] submissionParams \u003d {","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"BunnyHoppp"},"content":"                Const.ParamsNames.FEEDBACK_QUESTION_ID, typicalFeedbackQuestion.getId().toString(),","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"BunnyHoppp"},"content":"        };","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"BunnyHoppp"},"content":"        loginAsInstructor(instructorWithoutAccess.getGoogleId());","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"BunnyHoppp"},"content":"        verifyCannotAccess(submissionParams);","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"BunnyHoppp"},"content":"    }","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"BunnyHoppp"},"content":"","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"BunnyHoppp"},"content":"}","isFullCredit":false}],"authorContributionMap":{"BunnyHoppp":132}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteFeedbackSessionActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"mingyang143"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"mingyang143"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"mingyang143"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"mingyang143"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.FeedbackSession;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.webapi.DeleteFeedbackSessionAction;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"mingyang143"},"content":"/**","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"mingyang143"},"content":" * SUT: {@link DeleteFeedbackSessionAction}.","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"mingyang143"},"content":" */","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"mingyang143"},"content":"public class DeleteFeedbackSessionActionTest extends BaseActionTest\u003cDeleteFeedbackSessionAction\u003e {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"mingyang143"},"content":"    private String googleId \u003d \"user-googleId\";","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"mingyang143"},"content":"    private Course course;","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"mingyang143"},"content":"    private FeedbackSession session;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"mingyang143"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"mingyang143"},"content":"        return Const.ResourceURIs.SESSION;","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"mingyang143"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"mingyang143"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"mingyang143"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"mingyang143"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"mingyang143"},"content":"        course \u003d new Course(\"course-id\", \"name\", Const.DEFAULT_TIME_ZONE, \"institute\");","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"mingyang143"},"content":"        session \u003d new FeedbackSession(","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"mingyang143"},"content":"                \"session-name\",","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"mingyang143"},"content":"                course,","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"mingyang143"},"content":"                \"creater_email@tm.tmt\",","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"mingyang143"},"content":"                null,","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"mingyang143"},"content":"                Instant.parse(\"2020-01-01T00:00:00.000Z\"),","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"mingyang143"},"content":"                Instant.parse(\"2020-10-01T00:00:00.000Z\"),","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"mingyang143"},"content":"                Instant.parse(\"2020-01-01T00:00:00.000Z\"),","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"mingyang143"},"content":"                Instant.parse(\"2020-11-01T00:00:00.000Z\"),","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"mingyang143"},"content":"                null,","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"mingyang143"},"content":"                false,","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"mingyang143"},"content":"                false,","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"mingyang143"},"content":"                false);","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(googleId);","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_sessionDoesNotExist_failSilently() {","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"mingyang143"},"content":"        String sessionName \u003d \"incorrect-name\";","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, sessionName,","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"mingyang143"},"content":"        DeleteFeedbackSessionAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"mingyang143"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"mingyang143"},"content":"        assertEquals(\"The feedback session is deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"mingyang143"},"content":"        verify(mockLogic, times(1))","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"mingyang143"},"content":"                .deleteFeedbackSessionCascade(sessionName, course.getId());","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_sessionExists_success() {","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, session.getName(),","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, session.getCourseId(),","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"mingyang143"},"content":"        DeleteFeedbackSessionAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"mingyang143"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"mingyang143"},"content":"        assertEquals(\"The feedback session is deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"mingyang143"},"content":"        verify(mockLogic, times(1))","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"mingyang143"},"content":"                .deleteFeedbackSessionCascade(session.getName(), session.getCourseId());","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_missingParameters_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, \"session-name\",","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"mingyang143"},"content":"        String[] params2 \u003d {","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, \"course-id\",","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params2);","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"mingyang143"},"content":"        String[] params3 \u003d {","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, null,","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params3);","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"mingyang143"},"content":"        String[] params4 \u003d {","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, session.getName(),","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, null,","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params4);","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"mingyang143"},"content":"        String[] params5 \u003d {","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, null,","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, null,","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params5);","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_notInstructor_cannotAccess() {","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, session.getName(),","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, session.getCourseId(),","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"mingyang143"},"content":"        loginAsStudent(googleId);","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"mingyang143"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_instructorWithPermission_canAccess() {","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"mingyang143"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"mingyang143"},"content":"        instructorPrivileges.updatePrivilege(Const.InstructorPermissions.CAN_MODIFY_SESSION, true);","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d new Instructor(course, \"name\", \"instructoremail@tm.tmt\",","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"mingyang143"},"content":"                false, \"\", null, instructorPrivileges);","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(googleId);","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), googleId)).thenReturn(instructor);","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getFeedbackSessionFromRecycleBin(session.getName(), course.getId())).thenReturn(session);","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, session.getName(),","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, session.getCourseId(),","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"mingyang143"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_instructorWithoutPermission_cannotAccess() {","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"mingyang143"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d new Instructor(course, \"name\", \"instructoremail@tm.tmt\",","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"mingyang143"},"content":"                false, \"\", null, instructorPrivileges);","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(googleId);","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), googleId)).thenReturn(instructor);","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getFeedbackSessionFromRecycleBin(session.getName(), course.getId())).thenReturn(session);","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.FEEDBACK_SESSION_NAME, session.getName(),","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, session.getCourseId(),","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"mingyang143"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":166}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteInstructorActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"DhiraPT"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.never;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"DhiraPT"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"DhiraPT"},"content":"import org.mockito.Mockito;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Account;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Student;","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.webapi.DeleteInstructorAction;","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.webapi.InvalidOperationException;","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"DhiraPT"},"content":"/**","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"DhiraPT"},"content":" * SUT: {@link DeleteInstructorAction}.","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"DhiraPT"},"content":" */","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"DhiraPT"},"content":"public class DeleteInstructorActionTest extends BaseActionTest\u003cDeleteInstructorAction\u003e {","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"DhiraPT"},"content":"    private Course course;","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"DhiraPT"},"content":"    private Instructor instructor;","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"DhiraPT"},"content":"    private Instructor instructor2;","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"DhiraPT"},"content":"    private Student student;","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"DhiraPT"},"content":"    private String studentId \u003d \"student-googleId\";","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"DhiraPT"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"DhiraPT"},"content":"        return Const.ResourceURIs.INSTRUCTOR;","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"DhiraPT"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"DhiraPT"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"DhiraPT"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"DhiraPT"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"DhiraPT"},"content":"        Mockito.reset(mockLogic);","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"DhiraPT"},"content":"        course \u003d getTypicalCourse();","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"DhiraPT"},"content":"        instructor \u003d setupInstructor(\"instructor-googleId\", \"instructoremail@teammates.tmt\");","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"DhiraPT"},"content":"        instructor2 \u003d setupInstructor(\"instructor2-googleId\", \"instructor2email@teammates.tmt\");","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"DhiraPT"},"content":"        student \u003d getTypicalStudent();","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"DhiraPT"},"content":"        setupMockLogic();","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"DhiraPT"},"content":"    private Instructor setupInstructor(String googleId, String email) {","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"DhiraPT"},"content":"        Account account \u003d getTypicalAccount();","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"DhiraPT"},"content":"        account.setGoogleId(googleId);","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"DhiraPT"},"content":"        account.setEmail(email);","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"DhiraPT"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"DhiraPT"},"content":"        instructor.setEmail(email);","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"DhiraPT"},"content":"        instructor.setDisplayedToStudents(true);","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"DhiraPT"},"content":"        instructor.setAccount(account);","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"DhiraPT"},"content":"        return instructor;","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"DhiraPT"},"content":"    private void setupMockLogic() {","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), instructor.getGoogleId())).thenReturn(instructor);","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), instructor2.getGoogleId())).thenReturn(instructor2);","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentByGoogleId(course.getId(), studentId)).thenReturn(student);","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorForEmail(course.getId(), instructor.getEmail())).thenReturn(instructor);","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorForEmail(course.getId(), instructor2.getEmail())).thenReturn(instructor2);","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorsByCourse(course.getId())).thenReturn(List.of(instructor, instructor2));","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentsForCourse(course.getId())).thenReturn(List.of(student));","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteInstructorByGoogleId_success() {","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor2.getGoogleId(),","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), instructor2.getGoogleId());","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(course.getId(), instructor2.getEmail());","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteInstructorByEmail_success() {","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_EMAIL, instructor2.getEmail(),","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorForEmail(course.getId(), instructor2.getEmail());","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(course.getId(), instructor2.getEmail());","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_onlyOneInstructorInCourse_throwsInvalidOperationException() {","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"DhiraPT"},"content":"        // Override the mock logic for the course to have only one instructor","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorsByCourse(course.getId())).thenReturn(List.of(instructor));","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(mockLogic.getInstructorsByCourse(course.getId()).size(), 1);","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"DhiraPT"},"content":"        InvalidOperationException ioe \u003d verifyInvalidOperation(params);","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"The instructor you are trying to delete is the last instructor in the course. \"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"DhiraPT"},"content":"                + \"Deleting the last instructor from the course is not allowed.\", ioe.getMessage());","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), instructor.getGoogleId());","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_onlyOneRegisteredInstructor_throwsInvalidOperationException() {","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"DhiraPT"},"content":"        instructor2.setAccount(null);","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"DhiraPT"},"content":"        InvalidOperationException ioe \u003d verifyInvalidOperation(params);","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"The instructor you are trying to delete is the last instructor in the course. \"","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"DhiraPT"},"content":"                + \"Deleting the last instructor from the course is not allowed.\", ioe.getMessage());","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), instructor.getGoogleId());","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_onlyOneInstructorDisplayedToStudents_throwsInvalidOperationException() {","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"DhiraPT"},"content":"        instructor2.setDisplayedToStudents(false);","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"DhiraPT"},"content":"        InvalidOperationException ioe \u003d verifyInvalidOperation(params);","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"The instructor you are trying to delete is the last instructor in the course. \"","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"DhiraPT"},"content":"                + \"Deleting the last instructor from the course is not allowed.\", ioe.getMessage());","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), instructor.getGoogleId());","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_instructorDeleteOwnRoleByGoogleId_success() {","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":174,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":175,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":176,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":177,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":178,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":179,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":180,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), instructor.getGoogleId());","isFullCredit":false},{"lineNumber":181,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(course.getId(), instructor.getEmail());","isFullCredit":false},{"lineNumber":182,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":183,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":184,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":185,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":186,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":187,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteNonExistentInstructorByGoogleId_failSilently() {","isFullCredit":false},{"lineNumber":188,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), \"fake-googleId\")).thenReturn(null);","isFullCredit":false},{"lineNumber":189,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":190,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":191,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":192,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, \"fake-googleId\",","isFullCredit":false},{"lineNumber":193,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":194,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":195,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":196,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":197,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":198,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(course.getId(), \"fake-googleId\");","isFullCredit":false},{"lineNumber":199,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":200,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":201,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":202,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":203,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":204,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteNonExistentInstructorByEmail_failSilently() {","isFullCredit":false},{"lineNumber":205,"author":{"gitId":"DhiraPT"},"content":"        String fakeInstructorEmail \u003d \"fake-instructoremail@teammates.tmt\";","isFullCredit":false},{"lineNumber":206,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorForEmail(course.getId(), fakeInstructorEmail)).thenReturn(null);","isFullCredit":false},{"lineNumber":207,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":208,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":209,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":210,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_EMAIL, fakeInstructorEmail,","isFullCredit":false},{"lineNumber":211,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":212,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":213,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":214,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":215,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":216,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorForEmail(course.getId(), fakeInstructorEmail);","isFullCredit":false},{"lineNumber":217,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":218,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":219,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":220,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":221,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":222,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_nonExistentCourse_failSilently() {","isFullCredit":false},{"lineNumber":223,"author":{"gitId":"DhiraPT"},"content":"        String nonExistentCourseId \u003d \"non-existent-course-id\";","isFullCredit":false},{"lineNumber":224,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(nonExistentCourseId)).thenReturn(null);","isFullCredit":false},{"lineNumber":225,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":226,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":227,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, nonExistentCourseId,","isFullCredit":false},{"lineNumber":228,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":229,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":230,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":231,"author":{"gitId":"DhiraPT"},"content":"        DeleteInstructorAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":232,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":233,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":234,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getInstructorByGoogleId(nonExistentCourseId, instructor.getGoogleId());","isFullCredit":false},{"lineNumber":235,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteInstructorCascade(any(), any());","isFullCredit":false},{"lineNumber":236,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Instructor is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":237,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":238,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":239,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":240,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_noParameters_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":241,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure();","isFullCredit":false},{"lineNumber":242,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":243,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":244,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":245,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingCourseIdWithInstructorId_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":246,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":247,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":248,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":249,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":250,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":251,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":252,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":253,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":254,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingCourseIdWithInstructorEmail_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":255,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":256,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_EMAIL, instructor.getEmail(),","isFullCredit":false},{"lineNumber":257,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":258,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":259,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":260,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":261,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":262,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":263,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_onlyCourseId_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":264,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":265,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":266,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":267,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":268,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":269,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":270,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":271,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":272,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":273,"author":{"gitId":"DhiraPT"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":274,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":275,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":276,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":277,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":278,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":279,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":280,"author":{"gitId":"DhiraPT"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":281,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":282,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":283,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":284,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithPermission_canAccess() {","isFullCredit":false},{"lineNumber":285,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":286,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":287,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":288,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":289,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor2.getGoogleId(),","isFullCredit":false},{"lineNumber":290,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":291,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":292,"author":{"gitId":"DhiraPT"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":293,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":294,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":295,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":296,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithInvalidPermission_cannotAccess() {","isFullCredit":false},{"lineNumber":297,"author":{"gitId":"DhiraPT"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":298,"author":{"gitId":"DhiraPT"},"content":"        instructorPrivileges.updatePrivilege(Const.InstructorPermissions.CAN_MODIFY_INSTRUCTOR, false);","isFullCredit":false},{"lineNumber":299,"author":{"gitId":"DhiraPT"},"content":"        instructor.setPrivileges(instructorPrivileges);","isFullCredit":false},{"lineNumber":300,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":301,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":302,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":303,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":304,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":305,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor2.getGoogleId(),","isFullCredit":false},{"lineNumber":306,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":307,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":308,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":309,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":310,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":311,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":312,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorInDifferentCourse_cannotAccess() {","isFullCredit":false},{"lineNumber":313,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(\"instructor3-googleId\");","isFullCredit":false},{"lineNumber":314,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":315,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":316,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":317,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":318,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":319,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":320,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":321,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":322,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":323,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":324,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":325,"author":{"gitId":"DhiraPT"},"content":"        loginAsStudent(studentId);","isFullCredit":false},{"lineNumber":326,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":327,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":328,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":329,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":330,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":331,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":332,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":333,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":334,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":335,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":336,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":337,"author":{"gitId":"DhiraPT"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":338,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":339,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":340,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":341,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":342,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":343,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":344,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":345,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":346,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":347,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":348,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_unregistered_cannotAccess() {","isFullCredit":false},{"lineNumber":349,"author":{"gitId":"DhiraPT"},"content":"        loginAsUnregistered(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":350,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":351,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":352,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":353,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.INSTRUCTOR_ID, instructor.getGoogleId(),","isFullCredit":false},{"lineNumber":354,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":355,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":356,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":357,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":358,"author":{"gitId":"DhiraPT"},"content":"}","isFullCredit":false}],"authorContributionMap":{"DhiraPT":358}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteNotificationActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.reset;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.datatransfer.NotificationStyle;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.datatransfer.NotificationTargetUser;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.DeleteNotificationAction;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link DeleteNotificationAction}.","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":"public class DeleteNotificationActionTest extends BaseActionTest\u003cDeleteNotificationAction\u003e {","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"    private static final String GOOGLE_ID \u003d \"user-googleId\";","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATION;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_instructor_cannotAccess() {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(GOOGLE_ID);","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_notificationExists_success() {","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"        Notification testNotification \u003d new Notification(","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"                Instant.now(),","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"                Instant.ofEpochMilli(Instant.now().toEpochMilli() + 10000),","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"                NotificationStyle.INFO,","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"                NotificationTargetUser.GENERAL,","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"                \"title\",","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"                \"message\");","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getNotification(testNotification.getId())).thenReturn(testNotification);","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_ID, testNotification.getId().toString(),","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"        DeleteNotificationAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification has been deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"        reset(mockLogic);","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_notificationDoesNotExist_failSilently() {","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"        UUID invalidUuid \u003d UUID.randomUUID();","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getNotification(invalidUuid)).thenReturn(null);","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"InfinityTwo"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_ID, invalidUuid.toString(),","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"InfinityTwo"},"content":"        DeleteNotificationAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"InfinityTwo"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification has been deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"InfinityTwo"},"content":"        reset(mockLogic);","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_missingNotificationUuid_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"InfinityTwo"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_ID, null,","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_missingParameters_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"InfinityTwo"},"content":"        String[] params \u003d {};","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":112}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteStudentActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"DhiraPT"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.never;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"DhiraPT"},"content":"import org.mockito.Mockito;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Student;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.webapi.DeleteStudentAction;","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"DhiraPT"},"content":"/**","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"DhiraPT"},"content":" * SUT: {@link DeleteStudentAction}.","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"DhiraPT"},"content":" */","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"DhiraPT"},"content":"public class DeleteStudentActionTest extends BaseActionTest\u003cDeleteStudentAction\u003e {","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"DhiraPT"},"content":"    private Course course;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"DhiraPT"},"content":"    private Student student;","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"DhiraPT"},"content":"    private Instructor instructor;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"DhiraPT"},"content":"    private String studentId \u003d \"student-googleId\";","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"DhiraPT"},"content":"    private String instructorId \u003d \"instructor-googleId\";","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"DhiraPT"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"DhiraPT"},"content":"        return Const.ResourceURIs.STUDENT;","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"DhiraPT"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"DhiraPT"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"DhiraPT"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"DhiraPT"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"DhiraPT"},"content":"        Mockito.reset(mockLogic);","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"DhiraPT"},"content":"        course \u003d getTypicalCourse();","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"DhiraPT"},"content":"        student \u003d getTypicalStudent();","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"DhiraPT"},"content":"        instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"DhiraPT"},"content":"        setupMockLogic();","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"DhiraPT"},"content":"    private void setupMockLogic() {","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentByGoogleId(course.getId(), studentId)).thenReturn(student);","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentForEmail(course.getId(), student.getEmail())).thenReturn(student);","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), instructorId)).thenReturn(instructor);","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteStudentByEmail_success() {","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_EMAIL, student.getEmail(),","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).getStudentByGoogleId(any(), any());","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentCascade(course.getId(), student.getEmail());","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Student is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteStudentById_success() {","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getStudentByGoogleId(course.getId(), studentId);","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentCascade(course.getId(), student.getEmail());","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Student is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_nonExistentCourse_failSilently() {","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(\"RANDOM_COURSE\")).thenReturn(null);","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, \"RANDOM_COURSE\",","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getStudentByGoogleId(\"RANDOM_COURSE\", studentId);","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteStudentCascade(any(), any());","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Student is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_nonExistentStudentId_failSilently() {","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentByGoogleId(course.getId(), \"RANDOM_STUDENT\")).thenReturn(null);","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, \"RANDOM_STUDENT\",","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).getStudentByGoogleId(course.getId(), \"RANDOM_STUDENT\");","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteStudentCascade(any(), any());","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Student is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_nonExistentStudentEmail_failSilently() {","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getStudentForEmail(course.getId(), \"RANDOM_EMAIL\")).thenReturn(null);","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_EMAIL, \"RANDOM_EMAIL\",","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).getStudentByGoogleId(any(), any());","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentCascade(course.getId(), \"RANDOM_EMAIL\");","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentCascade(any(), any());","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteStudentCascade(course.getId(), student.getEmail());","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Student is successfully deleted.\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_noParameters_throwsInvalidParametersException() {","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure();","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingStudentIdOrEmail_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingCourseIdWithStudentId_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingCourseIdWithStudentEmail_throwsInvalidHttpParameterException() {","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_EMAIL, student.getEmail(),","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":174,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":175,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":176,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":177,"author":{"gitId":"DhiraPT"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":178,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":179,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":180,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":181,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":182,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":183,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":184,"author":{"gitId":"DhiraPT"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":185,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":186,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":187,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":188,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithPermission_canAccess() {","isFullCredit":false},{"lineNumber":189,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructorId);","isFullCredit":false},{"lineNumber":190,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":191,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":192,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":193,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":194,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":195,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":196,"author":{"gitId":"DhiraPT"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":197,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":198,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":199,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":200,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithInvalidPermission_cannotAccess() {","isFullCredit":false},{"lineNumber":201,"author":{"gitId":"DhiraPT"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":202,"author":{"gitId":"DhiraPT"},"content":"        instructorPrivileges.updatePrivilege(Const.InstructorPermissions.CAN_MODIFY_STUDENT, false);","isFullCredit":false},{"lineNumber":203,"author":{"gitId":"DhiraPT"},"content":"        instructor.setPrivileges(instructorPrivileges);","isFullCredit":false},{"lineNumber":204,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":205,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":206,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":207,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":208,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":209,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":210,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":211,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":212,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":213,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":214,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":215,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":216,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorInDifferentCourse_cannotAccess() {","isFullCredit":false},{"lineNumber":217,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(\"instructor2-googleId\");","isFullCredit":false},{"lineNumber":218,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":219,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":220,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":221,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":222,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":223,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":224,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":225,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":226,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":227,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":228,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":229,"author":{"gitId":"DhiraPT"},"content":"        loginAsStudent(studentId);","isFullCredit":false},{"lineNumber":230,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":231,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":232,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":233,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":234,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":235,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":236,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":237,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":238,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":239,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":240,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":241,"author":{"gitId":"DhiraPT"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":242,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":243,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":244,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":245,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.STUDENT_ID, studentId,","isFullCredit":false},{"lineNumber":246,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":247,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":248,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":249,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":250,"author":{"gitId":"DhiraPT"},"content":"}","isFullCredit":false}],"authorContributionMap":{"DhiraPT":250}},{"path":"src/test/java/teammates/sqlui/webapi/DeleteStudentsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"DhiraPT"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.never;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.times;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.verify;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"DhiraPT"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"DhiraPT"},"content":"import org.mockito.Mockito;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"DhiraPT"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"DhiraPT"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"DhiraPT"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.output.MessageOutput;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"DhiraPT"},"content":"import teammates.ui.webapi.DeleteStudentsAction;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"DhiraPT"},"content":"/**","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"DhiraPT"},"content":" * SUT: {@link DeleteStudentsAction}.","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"DhiraPT"},"content":" */","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"DhiraPT"},"content":"public class DeleteStudentsActionTest extends BaseActionTest\u003cDeleteStudentsAction\u003e {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"DhiraPT"},"content":"    private static final int DELETE_LIMIT \u003d 3;","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"DhiraPT"},"content":"    private Course course;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"DhiraPT"},"content":"    private Instructor instructor;","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"DhiraPT"},"content":"    private String instructorId \u003d \"instructor-googleId\";","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"DhiraPT"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"DhiraPT"},"content":"        return Const.ResourceURIs.STUDENTS;","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"DhiraPT"},"content":"    @Override","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"DhiraPT"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"DhiraPT"},"content":"        return DELETE;","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"DhiraPT"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"DhiraPT"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"DhiraPT"},"content":"        Mockito.reset(mockLogic);","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"DhiraPT"},"content":"        course \u003d getTypicalCourse();","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"DhiraPT"},"content":"        instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"DhiraPT"},"content":"        setupMockLogic();","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"DhiraPT"},"content":"    private void setupMockLogic() {","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), instructorId)).thenReturn(instructor);","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_deleteLimitedStudents_success() {","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentsAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentsInCourseCascade(course.getId());","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Successful\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_nonExistentCourse_failSilently() {","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"DhiraPT"},"content":"        when(mockLogic.getCourse(\"RANDOM_ID\")).thenReturn(null);","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, \"RANDOM_ID\",","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"DhiraPT"},"content":"        DeleteStudentsAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"DhiraPT"},"content":"        MessageOutput actionOutput \u003d (MessageOutput) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentsInCourseCascade(\"RANDOM_ID\");","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, times(1)).deleteStudentsInCourseCascade(any());","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"DhiraPT"},"content":"        verify(mockLogic, never()).deleteStudentsInCourseCascade(course.getId());","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"DhiraPT"},"content":"        assertEquals(\"Successful\", actionOutput.getMessage());","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_noParameters_throwsInvalidParametersException() {","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure();","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingCourseId_throwsInvalidParametersException() {","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"DhiraPT"},"content":"    void testExecute_missingLimit_throwsInvalidParametersException() {","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"DhiraPT"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithPermission_canAccess() {","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructorId);","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"DhiraPT"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorWithInvalidPermission_cannotAccess() {","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"DhiraPT"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"DhiraPT"},"content":"        instructorPrivileges.updatePrivilege(Const.InstructorPermissions.CAN_MODIFY_STUDENT, false);","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"DhiraPT"},"content":"        instructor.setPrivileges(instructorPrivileges);","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(instructorId);","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_instructorInDifferentCourse_cannotAccess() {","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"DhiraPT"},"content":"        loginAsInstructor(\"instructor2-googleId\");","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"DhiraPT"},"content":"        loginAsStudent(\"student-googleId\");","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"DhiraPT"},"content":"    @Test","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"DhiraPT"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"DhiraPT"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"DhiraPT"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"DhiraPT"},"content":"                Const.ParamsNames.LIMIT, String.valueOf(DELETE_LIMIT),","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"DhiraPT"},"content":"        };","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"DhiraPT"},"content":"","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"DhiraPT"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"DhiraPT"},"content":"    }","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"DhiraPT"},"content":"}","isFullCredit":false}],"authorContributionMap":{"DhiraPT":173}},{"path":"src/test/java/teammates/sqlui/webapi/EnrollStudentsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"mingyang143"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.ArgumentMatchers.argThat;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.doThrow;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"mingyang143"},"content":"import java.util.ArrayList;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"mingyang143"},"content":"import java.util.Arrays;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"mingyang143"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"mingyang143"},"content":"import java.util.Objects;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"mingyang143"},"content":"import teammates.common.datatransfer.InstructorPrivileges;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"mingyang143"},"content":"import teammates.common.exception.EntityAlreadyExistsException;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"mingyang143"},"content":"import teammates.common.exception.EntityDoesNotExistException;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"mingyang143"},"content":"import teammates.common.exception.InvalidParametersException;","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"mingyang143"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Course;","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Section;","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Student;","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Team;","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.EnrollStudentsData;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.StudentData;","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.request.StudentsEnrollRequest;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.webapi.EnrollStudentsAction;","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"mingyang143"},"content":"/**","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"mingyang143"},"content":" * Test cases for the {@link EnrollStudentsAction} class.","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"mingyang143"},"content":" */","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"mingyang143"},"content":"public class EnrollStudentsActionTest extends BaseActionTest\u003cEnrollStudentsAction\u003e {","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"mingyang143"},"content":"    private Course course;","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"mingyang143"},"content":"    private Team team;","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"mingyang143"},"content":"    private Section section;","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"mingyang143"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"mingyang143"},"content":"        return Const.ResourceURIs.STUDENTS;","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"mingyang143"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"mingyang143"},"content":"        return PUT;","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"mingyang143"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"mingyang143"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"mingyang143"},"content":"        course \u003d new Course(\"course-id\", \"name\", Const.DEFAULT_TIME_ZONE, \"institute\");","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"mingyang143"},"content":"        section \u003d new Section(course, \"section\");","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"mingyang143"},"content":"        team \u003d new Team(section, course.getId());","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_withNewStudent_shouldBeAdded() throws Exception {","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"mingyang143"},"content":"        Student newStudent \u003d new Student(course, \"name\", \"email.com\", \"\", team);","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentsForCourse(course.getId())).thenReturn(new ArrayList\u003c\u003e());","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.createStudent(","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"mingyang143"},"content":"                argThat(argument -\u003e Objects.equals(argument.getName(), newStudent.getName())","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getEmail(), newStudent.getEmail())","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getTeam(), newStudent.getTeam())","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getSection(), newStudent.getSection())))).thenReturn(newStudent);","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getTeamOrCreate(section, \"team\")).thenReturn(team);","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getSectionOrCreate(course.getId(), \"section\")).thenReturn(section);","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"mingyang143"},"content":"        StudentsEnrollRequest req \u003d prepareRequest(newStudent);","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"mingyang143"},"content":"        EnrollStudentsAction action \u003d getAction(req, params);","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"mingyang143"},"content":"        JsonResult result \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"mingyang143"},"content":"        List\u003cStudentData\u003e enrolledStudents \u003d ((EnrollStudentsData) result.getOutput()).getStudentsData().getStudents();","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"mingyang143"},"content":"        assertEquals(1, enrolledStudents.size());","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"mingyang143"},"content":"        assertEquals(enrolledStudents.get(0).getEmail(), newStudent.getEmail());","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"mingyang143"},"content":"        verifySpecifiedTasksAdded(Const.TaskQueue.SEARCH_INDEXING_QUEUE_NAME, 1);","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_studentAlreadyEnrolled_updateStudent() throws Exception {","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"mingyang143"},"content":"        Student newStudent \u003d new Student(course, \"name\", \"email.com\", \"\", team);","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"mingyang143"},"content":"        Student existingStudent \u003d new Student(course, \"oldName\", \"email.com\", \"\", team);","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentsForCourse(course.getId())).thenReturn(new ArrayList\u003c\u003e(List.of(existingStudent)));","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentForEmail(course.getId(), newStudent.getEmail())).thenReturn(existingStudent);","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getTeamOrCreate(section, \"team\")).thenReturn(team);","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getSectionOrCreate(course.getId(), \"section\")).thenReturn(section);","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.updateStudentCascade(","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"mingyang143"},"content":"                argThat(argument -\u003e Objects.equals(argument.getName(), newStudent.getName())","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getEmail(), newStudent.getEmail())","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getTeam(), newStudent.getTeam())","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"mingyang143"},"content":"                        \u0026\u0026 Objects.equals(argument.getSection(), newStudent.getSection())))).thenReturn(newStudent);","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"mingyang143"},"content":"        StudentsEnrollRequest req \u003d prepareRequest(newStudent);","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"mingyang143"},"content":"        EnrollStudentsAction action \u003d getAction(req, params);","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"mingyang143"},"content":"        JsonResult result \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"mingyang143"},"content":"        List\u003cStudentData\u003e enrolledStudents \u003d ((EnrollStudentsData) result.getOutput()).getStudentsData().getStudents();","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"mingyang143"},"content":"        assertEquals(enrolledStudents.size(), 1);","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"mingyang143"},"content":"        assertEquals(enrolledStudents.get(0).getName(), newStudent.getName());","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"mingyang143"},"content":"        verifySpecifiedTasksAdded(Const.TaskQueue.SEARCH_INDEXING_QUEUE_NAME, 1);","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_invalidParamsAndNotAlreadyEnrolled_studentAddedToErrorList() throws","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"mingyang143"},"content":"            EntityAlreadyExistsException, InvalidParametersException {","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"mingyang143"},"content":"        doThrow(new InvalidParametersException(\"\")).when(mockLogic).createStudent(any(Student.class));","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"mingyang143"},"content":"        Student newStudent \u003d new Student(course, \"name\", \"email.com\", \"\", team);","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentsForCourse(course.getId())).thenReturn(new ArrayList\u003c\u003e());","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getTeamOrCreate(section, \"team\")).thenReturn(team);","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getSectionOrCreate(course.getId(), \"section\")).thenReturn(section);","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"mingyang143"},"content":"        StudentsEnrollRequest req \u003d prepareRequest(newStudent);","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"mingyang143"},"content":"        EnrollStudentsAction action \u003d getAction(req, params);","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"mingyang143"},"content":"        JsonResult result \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"mingyang143"},"content":"        List\u003cStudentData\u003e enrolledStudents \u003d ((EnrollStudentsData) result.getOutput()).getStudentsData().getStudents();","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"mingyang143"},"content":"        List\u003cEnrollStudentsData.EnrollErrorResults\u003e errors \u003d","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"mingyang143"},"content":"                ((EnrollStudentsData) result.getOutput()).getUnsuccessfulEnrolls();","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"mingyang143"},"content":"        assertEquals(errors.size(), 1);","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"mingyang143"},"content":"        assertEquals(enrolledStudents.size(), 0);","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_invalidParamsAndAlreadyEnrolled_studentAddedToErrorList()","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"mingyang143"},"content":"            throws InvalidParametersException, EntityDoesNotExistException, EntityAlreadyExistsException {","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"mingyang143"},"content":"        doThrow(new InvalidParametersException(\"\")).when(mockLogic).updateStudentCascade(any(Student.class));","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"mingyang143"},"content":"        Student newStudent \u003d new Student(course, \"name\", \"email.com\", \"\", team);","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentsForCourse(course.getId())).thenReturn(new ArrayList\u003c\u003e(List.of(newStudent)));","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getStudentForEmail(course.getId(), newStudent.getEmail())).thenReturn(newStudent);","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getTeamOrCreate(section, \"team\")).thenReturn(team);","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getSectionOrCreate(course.getId(), \"section\")).thenReturn(section);","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"mingyang143"},"content":"        StudentsEnrollRequest req \u003d prepareRequest(newStudent);","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"mingyang143"},"content":"        EnrollStudentsAction action \u003d getAction(req, params);","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"mingyang143"},"content":"        JsonResult result \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"mingyang143"},"content":"        List\u003cStudentData\u003e enrolledStudents \u003d ((EnrollStudentsData) result.getOutput()).getStudentsData().getStudents();","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"mingyang143"},"content":"        List\u003cEnrollStudentsData.EnrollErrorResults\u003e errors \u003d","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"mingyang143"},"content":"                ((EnrollStudentsData) result.getOutput()).getUnsuccessfulEnrolls();","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"mingyang143"},"content":"        assertEquals(errors.size(), 1);","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"mingyang143"},"content":"        assertEquals(enrolledStudents.size(), 0);","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"mingyang143"},"content":"    public void testExecute_invalidCourseId_invalidHttpRequestBodyException() {","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, null,","isFullCredit":false},{"lineNumber":174,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":175,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":176,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":177,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":178,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":179,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":180,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_instructorWithInvalidPermission_cannotAccess() {","isFullCredit":false},{"lineNumber":181,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d new Instructor(course, \"name\", \"instructoremail@tm.tmt\",","isFullCredit":false},{"lineNumber":182,"author":{"gitId":"mingyang143"},"content":"                false, \"\", null, new InstructorPrivileges());","isFullCredit":false},{"lineNumber":183,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":184,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":185,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":186,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":187,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":188,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":189,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":190,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":191,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":192,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_instructorWithValidPermission_canAccess() {","isFullCredit":false},{"lineNumber":193,"author":{"gitId":"mingyang143"},"content":"        InstructorPrivileges instructorPrivileges \u003d new InstructorPrivileges();","isFullCredit":false},{"lineNumber":194,"author":{"gitId":"mingyang143"},"content":"        instructorPrivileges.updatePrivilege(Const.InstructorPermissions.CAN_MODIFY_STUDENT, true);","isFullCredit":false},{"lineNumber":195,"author":{"gitId":"mingyang143"},"content":"        Instructor instructor \u003d new Instructor(course, \"name\", \"instructoremail@tm.tmt\",","isFullCredit":false},{"lineNumber":196,"author":{"gitId":"mingyang143"},"content":"                false, \"\", null, instructorPrivileges);","isFullCredit":false},{"lineNumber":197,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":198,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getInstructorByGoogleId(course.getId(), instructor.getGoogleId())).thenReturn(instructor);","isFullCredit":false},{"lineNumber":199,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getCourse(course.getId())).thenReturn(course);","isFullCredit":false},{"lineNumber":200,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d new String[] {","isFullCredit":false},{"lineNumber":201,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":202,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":203,"author":{"gitId":"mingyang143"},"content":"        verifyCanAccess(params);","isFullCredit":false},{"lineNumber":204,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":205,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":206,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":207,"author":{"gitId":"mingyang143"},"content":"    public void testSpecificAccessControl_notInstructor_cannotAccess() {","isFullCredit":false},{"lineNumber":208,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":209,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.COURSE_ID, course.getId(),","isFullCredit":false},{"lineNumber":210,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":211,"author":{"gitId":"mingyang143"},"content":"        loginAsStudent(\"random-id\");","isFullCredit":false},{"lineNumber":212,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":213,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":214,"author":{"gitId":"mingyang143"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":215,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess(params);","isFullCredit":false},{"lineNumber":216,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":217,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":218,"author":{"gitId":"mingyang143"},"content":"    private StudentsEnrollRequest prepareRequest(Student... studentsToEnroll) {","isFullCredit":false},{"lineNumber":219,"author":{"gitId":"mingyang143"},"content":"        List\u003cStudentsEnrollRequest.StudentEnrollRequest\u003e requestList \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":220,"author":{"gitId":"mingyang143"},"content":"        Arrays.stream(studentsToEnroll).forEach(student -\u003e requestList.add(","isFullCredit":false},{"lineNumber":221,"author":{"gitId":"mingyang143"},"content":"                new StudentsEnrollRequest.StudentEnrollRequest(student.getName(), student.getEmail(),","isFullCredit":false},{"lineNumber":222,"author":{"gitId":"mingyang143"},"content":"                \"team\", \"section\", student.getComments())));","isFullCredit":false},{"lineNumber":223,"author":{"gitId":"mingyang143"},"content":"        return new StudentsEnrollRequest(requestList);","isFullCredit":false},{"lineNumber":224,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":225,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":226,"author":{"gitId":"mingyang143"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":226}},{"path":"src/test/java/teammates/sqlui/webapi/GetAccountsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"mingyang143"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"mingyang143"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"mingyang143"},"content":"import java.util.ArrayList;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"mingyang143"},"content":"import java.util.Collections;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"mingyang143"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"mingyang143"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"mingyang143"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"mingyang143"},"content":"import teammates.storage.sqlentity.Account;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.AccountData;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.output.AccountsData;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"mingyang143"},"content":"import teammates.ui.webapi.GetAccountsAction;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"mingyang143"},"content":"/**","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"mingyang143"},"content":" * SUT: {@link GetAccountsAction}.","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"mingyang143"},"content":" */","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"mingyang143"},"content":"public class GetAccountsActionTest extends BaseActionTest\u003cGetAccountsAction\u003e {","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"mingyang143"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"mingyang143"},"content":"        return Const.ResourceURIs.ACCOUNTS;","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"mingyang143"},"content":"    @Override","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"mingyang143"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"mingyang143"},"content":"        return GET;","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"mingyang143"},"content":"    private void verifyAccounts(List\u003cAccountData\u003e accountDataList, List\u003cAccount\u003e accounts) {","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"mingyang143"},"content":"        assertEquals(accountDataList.size(), accounts.size());","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"mingyang143"},"content":"        for (int i \u003d 0; i \u003c accountDataList.size(); i++) {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"mingyang143"},"content":"            AccountData accountData \u003d accountDataList.get(i);","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"mingyang143"},"content":"            Account account \u003d accounts.get(i);","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"mingyang143"},"content":"            assertEquals(accountData.getGoogleId(), account.getGoogleId());","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"mingyang143"},"content":"            assertEquals(accountData.getEmail(), account.getEmail());","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"mingyang143"},"content":"            assertEquals(accountData.getName(), account.getName());","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"mingyang143"},"content":"        }","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"mingyang143"},"content":"    void testExecute_multipleAccountsWithEmail_multipleAccountsFetched() {","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"mingyang143"},"content":"        List\u003cAccount\u003e accounts \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"mingyang143"},"content":"        Account accountStub \u003d getTypicalAccount();","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"mingyang143"},"content":"        Account anotherAccountStub \u003d new Account(\"anotherGoogleId\", \"anotherEmail\",","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"mingyang143"},"content":"                accountStub.getEmail());","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"mingyang143"},"content":"        accounts.add(accountStub);","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"mingyang143"},"content":"        accounts.add(anotherAccountStub);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getAccountsForEmail(accountStub.getEmail())).thenReturn(accounts);","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.USER_EMAIL, accountStub.getEmail(),","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"mingyang143"},"content":"        GetAccountsAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"mingyang143"},"content":"        AccountsData actionOutput \u003d (AccountsData) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"mingyang143"},"content":"        List\u003cAccountData\u003e accountDataList \u003d actionOutput.getAccounts();","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"mingyang143"},"content":"        verifyAccounts(accountDataList, accounts);","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"mingyang143"},"content":"    void testExecute_oneAccountWithEmail_accountFetched() {","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"mingyang143"},"content":"        List\u003cAccount\u003e accounts \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"mingyang143"},"content":"        Account accountStub \u003d getTypicalAccount();","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"mingyang143"},"content":"        accounts.add(accountStub);","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getAccountsForEmail(accountStub.getEmail())).thenReturn(accounts);","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.USER_EMAIL, accountStub.getEmail(),","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"mingyang143"},"content":"        GetAccountsAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"mingyang143"},"content":"        AccountsData actionOutput \u003d (AccountsData) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"mingyang143"},"content":"        List\u003cAccountData\u003e accountDataList \u003d actionOutput.getAccounts();","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"mingyang143"},"content":"        verifyAccounts(accountDataList, accounts);","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"mingyang143"},"content":"    void testExecute_noAccountsWithEmail_noAccountsFetched() {","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"mingyang143"},"content":"        when(mockLogic.getAccountsForEmail(\"email\")).thenReturn(Collections.emptyList());","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.USER_EMAIL, \"email\",","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"mingyang143"},"content":"        GetAccountsAction action \u003d getAction(params);","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"mingyang143"},"content":"        AccountsData actionOutput \u003d (AccountsData) getJsonResult(action).getOutput();","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"mingyang143"},"content":"        List\u003cAccountData\u003e accountDataList \u003d actionOutput.getAccounts();","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"mingyang143"},"content":"        verifyAccounts(accountDataList, Collections.emptyList());","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"mingyang143"},"content":"    void textExecute_invalidParams_throwsInvalidParametersException() {","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"mingyang143"},"content":"        String[] params \u003d {","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"mingyang143"},"content":"                Const.ParamsNames.USER_EMAIL, null,","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"mingyang143"},"content":"        };","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params);","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"mingyang143"},"content":"        String[] params2 \u003d {};","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"mingyang143"},"content":"        verifyHttpParameterFailure(params2);","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"mingyang143"},"content":"    void testSpecificAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"mingyang143"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"mingyang143"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"mingyang143"},"content":"    void testSpecificAccessControl_instructor_cannotAccess() {","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"mingyang143"},"content":"        loginAsInstructor(getTypicalAccount().getGoogleId());","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"mingyang143"},"content":"    void testSpecificAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"mingyang143"},"content":"        loginAsStudent(getTypicalAccount().getGoogleId());","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"mingyang143"},"content":"    @Test","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"mingyang143"},"content":"    void testSpecificAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"mingyang143"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"mingyang143"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"mingyang143"},"content":"","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"mingyang143"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"mingyang143"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"mingyang143"},"content":"    }","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"mingyang143"},"content":"}","isFullCredit":false}],"authorContributionMap":{"mingyang143":128}},{"path":"src/test/java/teammates/sqlui/webapi/GetNotificationActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.reset;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.NotificationData;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.EntityNotFoundException;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.GetNotificationAction;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.InvalidHttpParameterException;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link GetNotificationAction}.","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"public class GetNotificationActionTest extends BaseActionTest\u003cGetNotificationAction\u003e {","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATION;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"        return GET;","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"    public void baseClassSetup() {","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_withValidNotificationId_shouldReturnData() {","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"        Notification testNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"        NotificationData expected \u003d new NotificationData(testNotification);","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_ID, String.valueOf(testNotification.getId()),","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getNotification(testNotification.getId())).thenReturn(testNotification);","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"        NotificationData output \u003d (NotificationData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"        verifyNotificationEquals(expected, output);","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"        reset(mockLogic);","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_nonExistentNotification_shouldThrowError() {","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationAction action \u003d getAction(Const.ParamsNames.NOTIFICATION_ID, UUID.randomUUID().toString());","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"        EntityNotFoundException enfe \u003d assertThrows(EntityNotFoundException.class, action::execute);","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"Notification does not exist.\", enfe.getMessage());","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_notificationIdIsNull_shouldThrowError() {","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationAction action \u003d getAction(Const.ParamsNames.NOTIFICATION_ID, null, new String[] {});","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"        InvalidHttpParameterException ihpe \u003d assertThrows(InvalidHttpParameterException.class, action::execute);","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(\"The [notificationid] HTTP parameter is null.\", ihpe.getMessage());","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"    private void verifyNotificationEquals(NotificationData expected, NotificationData actual) {","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getNotificationId(), actual.getNotificationId());","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getStyle(), actual.getStyle());","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getTargetUser(), actual.getTargetUser());","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getTitle(), actual.getTitle());","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getMessage(), actual.getMessage());","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getStartTimestamp(), actual.getStartTimestamp());","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getEndTimestamp(), actual.getEndTimestamp());","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":84}},{"path":"src/test/java/teammates/sqlui/webapi/GetNotificationsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import java.util.ArrayList;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import java.util.Set;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import java.util.stream.Collectors;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.datatransfer.NotificationTargetUser;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.NotificationData;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.NotificationsData;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.GetNotificationsAction;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link GetNotificationsAction}.","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"public class GetNotificationsActionTest extends BaseActionTest\u003cGetNotificationsAction\u003e {","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"    private static final String GOOGLE_ID \u003d \"user-googleId\";","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"    private static final int READ_NOTIFICATION_COUNT \u003d 5;","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"    private static final int UNREAD_NOTIFICATION_COUNT \u003d 10;","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATIONS;","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"        return GET;","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_instructorAccessStudentNotification_shouldFail() {","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.STUDENT.toString(),","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess(requestParams);","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_instructorAccessInstructorNotification_shouldSucceed() {","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess(requestParams);","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_studentAccessInstructorNotification_shouldFail() {","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(GOOGLE_ID);","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess(requestParams);","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_studentAccessStudentNotification_shouldSucceed() {","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(GOOGLE_ID);","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.STUDENT.toString(),","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess(requestParams);","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_unknownTargetUser_shouldFail() {","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, \"unknown\",","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailureAcl(requestParams);","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_adminAccessAllNotification_shouldSucceed() {","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, null,","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess(requestParams);","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_withValidUserTypeForNonAdmin_shouldReturnData() {","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"InfinityTwo"},"content":"        int expectedNumberOfNotifications \u003d UNREAD_NOTIFICATION_COUNT + READ_NOTIFICATION_COUNT;","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c expectedNumberOfNotifications; i++) {","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"InfinityTwo"},"content":"            testNotifications.add(getTypicalNotificationWithId());","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getActiveNotificationsByTargetUser(NotificationTargetUser.INSTRUCTOR))","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"InfinityTwo"},"content":"                .thenReturn(testNotifications);","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationsAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"InfinityTwo"},"content":"        NotificationsData output \u003d (NotificationsData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotificationData\u003e notifications \u003d output.getNotifications();","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"InfinityTwo"},"content":"        // should fetch correct number of notifications","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expectedNumberOfNotifications, notifications.size());","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_withoutUserTypeForAdmin_shouldReturnAllNotifications() {","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"InfinityTwo"},"content":"        final int expectedNumberOfNotifications \u003d 5;","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"InfinityTwo"},"content":"        Notification testNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":136,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c expectedNumberOfNotifications; i++) {","isFullCredit":false},{"lineNumber":137,"author":{"gitId":"InfinityTwo"},"content":"            testNotifications.add(getTypicalNotificationWithId());","isFullCredit":false},{"lineNumber":138,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":139,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":140,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getAllNotifications()).thenReturn(testNotifications);","isFullCredit":false},{"lineNumber":141,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getActiveNotificationsByTargetUser(testNotification.getTargetUser()))","isFullCredit":false},{"lineNumber":142,"author":{"gitId":"InfinityTwo"},"content":"                .thenReturn(testNotifications);","isFullCredit":false},{"lineNumber":143,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":144,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":145,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, null,","isFullCredit":false},{"lineNumber":146,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":147,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":148,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":149,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationsAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":150,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":151,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":152,"author":{"gitId":"InfinityTwo"},"content":"        NotificationsData output \u003d (NotificationsData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":153,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotificationData\u003e notificationOutput \u003d output.getNotifications();","isFullCredit":false},{"lineNumber":154,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":155,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expectedNumberOfNotifications, mockLogic.getAllNotifications().size());","isFullCredit":false},{"lineNumber":156,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expectedNumberOfNotifications, notificationOutput.size());","isFullCredit":false},{"lineNumber":157,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":158,"author":{"gitId":"InfinityTwo"},"content":"        NotificationData expected \u003d new NotificationData(testNotifications.get(0));","isFullCredit":false},{"lineNumber":159,"author":{"gitId":"InfinityTwo"},"content":"        NotificationData firstNotification \u003d notificationOutput.get(0);","isFullCredit":false},{"lineNumber":160,"author":{"gitId":"InfinityTwo"},"content":"        verifyNotificationEquals(expected, firstNotification);","isFullCredit":false},{"lineNumber":161,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":162,"author":{"gitId":"InfinityTwo"},"content":"        // notification\u0027s shown attribute should not be updated","isFullCredit":false},{"lineNumber":163,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e notificationToCheck \u003d","isFullCredit":false},{"lineNumber":164,"author":{"gitId":"InfinityTwo"},"content":"                mockLogic.getActiveNotificationsByTargetUser(testNotification.getTargetUser());","isFullCredit":false},{"lineNumber":165,"author":{"gitId":"InfinityTwo"},"content":"        notificationToCheck.forEach(n -\u003e assertFalse(n.isShown()));","isFullCredit":false},{"lineNumber":166,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":167,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":168,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":169,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_withoutUserTypeForNonAdmin_shouldFail() {","isFullCredit":false},{"lineNumber":170,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":171,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":172,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":173,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(true),","isFullCredit":false},{"lineNumber":174,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":175,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":176,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationsAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":177,"author":{"gitId":"InfinityTwo"},"content":"        assertThrows(AssertionError.class, action::execute);","isFullCredit":false},{"lineNumber":178,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":179,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":180,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":181,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_invalidUserType_shouldFail() {","isFullCredit":false},{"lineNumber":182,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":183,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":184,"author":{"gitId":"InfinityTwo"},"content":"        // when usertype is GENERAL","isFullCredit":false},{"lineNumber":185,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(Const.ParamsNames.NOTIFICATION_TARGET_USER,","isFullCredit":false},{"lineNumber":186,"author":{"gitId":"InfinityTwo"},"content":"                NotificationTargetUser.GENERAL.toString(),","isFullCredit":false},{"lineNumber":187,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL,","isFullCredit":false},{"lineNumber":188,"author":{"gitId":"InfinityTwo"},"content":"                String.valueOf(true));","isFullCredit":false},{"lineNumber":189,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":190,"author":{"gitId":"InfinityTwo"},"content":"        // when usertype is a random string","isFullCredit":false},{"lineNumber":191,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(Const.ParamsNames.NOTIFICATION_TARGET_USER,","isFullCredit":false},{"lineNumber":192,"author":{"gitId":"InfinityTwo"},"content":"                \"invalid string\",","isFullCredit":false},{"lineNumber":193,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL,","isFullCredit":false},{"lineNumber":194,"author":{"gitId":"InfinityTwo"},"content":"                String.valueOf(true));","isFullCredit":false},{"lineNumber":195,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":196,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":197,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":198,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_withFalseIsFetchingAll_shouldUpdateShownAndReturnUnreadNotifications() {","isFullCredit":false},{"lineNumber":199,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":200,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":201,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testAllNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":202,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testUnreadNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":203,"author":{"gitId":"InfinityTwo"},"content":"        Set\u003cString\u003e readNotificationsId;","isFullCredit":false},{"lineNumber":204,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":205,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c UNREAD_NOTIFICATION_COUNT; i++) {","isFullCredit":false},{"lineNumber":206,"author":{"gitId":"InfinityTwo"},"content":"            testUnreadNotifications.add(getTypicalNotificationWithId());","isFullCredit":false},{"lineNumber":207,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":208,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":209,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c READ_NOTIFICATION_COUNT; i++) {","isFullCredit":false},{"lineNumber":210,"author":{"gitId":"InfinityTwo"},"content":"            Notification readNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":211,"author":{"gitId":"InfinityTwo"},"content":"            readNotification.setShown();","isFullCredit":false},{"lineNumber":212,"author":{"gitId":"InfinityTwo"},"content":"            testAllNotifications.add(readNotification);","isFullCredit":false},{"lineNumber":213,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":214,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":215,"author":{"gitId":"InfinityTwo"},"content":"        readNotificationsId \u003d testAllNotifications.stream()","isFullCredit":false},{"lineNumber":216,"author":{"gitId":"InfinityTwo"},"content":"                .map(n -\u003e n.getId().toString())","isFullCredit":false},{"lineNumber":217,"author":{"gitId":"InfinityTwo"},"content":"                .collect(Collectors.toSet());","isFullCredit":false},{"lineNumber":218,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":219,"author":{"gitId":"InfinityTwo"},"content":"        testAllNotifications.addAll(testUnreadNotifications);","isFullCredit":false},{"lineNumber":220,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":221,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getAllNotifications()).thenReturn(testAllNotifications);","isFullCredit":false},{"lineNumber":222,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getActiveNotificationsByTargetUser(NotificationTargetUser.INSTRUCTOR))","isFullCredit":false},{"lineNumber":223,"author":{"gitId":"InfinityTwo"},"content":"                .thenReturn(testUnreadNotifications);","isFullCredit":false},{"lineNumber":224,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":225,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":226,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":227,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, String.valueOf(false),","isFullCredit":false},{"lineNumber":228,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":229,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":230,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationsAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":231,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":232,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":233,"author":{"gitId":"InfinityTwo"},"content":"        NotificationsData output \u003d (NotificationsData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":234,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotificationData\u003e notifications \u003d output.getNotifications();","isFullCredit":false},{"lineNumber":235,"author":{"gitId":"InfinityTwo"},"content":"        verifyDoesNotContainNotifications(notifications, readNotificationsId);","isFullCredit":false},{"lineNumber":236,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":237,"author":{"gitId":"InfinityTwo"},"content":"        // should update notification has shown attribute","isFullCredit":false},{"lineNumber":238,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e activeNotifications \u003d","isFullCredit":false},{"lineNumber":239,"author":{"gitId":"InfinityTwo"},"content":"                mockLogic.getActiveNotificationsByTargetUser(NotificationTargetUser.INSTRUCTOR);","isFullCredit":false},{"lineNumber":240,"author":{"gitId":"InfinityTwo"},"content":"        activeNotifications \u003d activeNotifications.stream()","isFullCredit":false},{"lineNumber":241,"author":{"gitId":"InfinityTwo"},"content":"                .filter(n -\u003e !readNotificationsId.contains(n.getId().toString()))","isFullCredit":false},{"lineNumber":242,"author":{"gitId":"InfinityTwo"},"content":"                .collect(Collectors.toList());","isFullCredit":false},{"lineNumber":243,"author":{"gitId":"InfinityTwo"},"content":"        activeNotifications.forEach(n -\u003e assertTrue(n.isShown()));","isFullCredit":false},{"lineNumber":244,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":245,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":246,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":247,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_withoutIsFetchingAll_shouldUpdateShownAndReturnUnreadNotifications() {","isFullCredit":false},{"lineNumber":248,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testAllNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":249,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testUnreadNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":250,"author":{"gitId":"InfinityTwo"},"content":"        Set\u003cString\u003e readNotificationsId;","isFullCredit":false},{"lineNumber":251,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":252,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":253,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":254,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c READ_NOTIFICATION_COUNT; i++) {","isFullCredit":false},{"lineNumber":255,"author":{"gitId":"InfinityTwo"},"content":"            Notification readNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":256,"author":{"gitId":"InfinityTwo"},"content":"            readNotification.setShown();","isFullCredit":false},{"lineNumber":257,"author":{"gitId":"InfinityTwo"},"content":"            testAllNotifications.add(readNotification);","isFullCredit":false},{"lineNumber":258,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":259,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":260,"author":{"gitId":"InfinityTwo"},"content":"        readNotificationsId \u003d testAllNotifications.stream()","isFullCredit":false},{"lineNumber":261,"author":{"gitId":"InfinityTwo"},"content":"                .map(n -\u003e n.getId().toString())","isFullCredit":false},{"lineNumber":262,"author":{"gitId":"InfinityTwo"},"content":"                .collect(Collectors.toSet());","isFullCredit":false},{"lineNumber":263,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":264,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getActiveNotificationsByTargetUser(NotificationTargetUser.INSTRUCTOR))","isFullCredit":false},{"lineNumber":265,"author":{"gitId":"InfinityTwo"},"content":"                .thenReturn(testUnreadNotifications);","isFullCredit":false},{"lineNumber":266,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":267,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":268,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":269,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":270,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":271,"author":{"gitId":"InfinityTwo"},"content":"        GetNotificationsAction action \u003d getAction(requestParams);","isFullCredit":false},{"lineNumber":272,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":273,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":274,"author":{"gitId":"InfinityTwo"},"content":"        NotificationsData output \u003d (NotificationsData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":275,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotificationData\u003e notifications \u003d output.getNotifications();","isFullCredit":false},{"lineNumber":276,"author":{"gitId":"InfinityTwo"},"content":"        verifyDoesNotContainNotifications(notifications, readNotificationsId);","isFullCredit":false},{"lineNumber":277,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":278,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":279,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":280,"author":{"gitId":"InfinityTwo"},"content":"    public void testExecute_withInvalidIsFetchingAll_shouldFail() {","isFullCredit":false},{"lineNumber":281,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(GOOGLE_ID);","isFullCredit":false},{"lineNumber":282,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":283,"author":{"gitId":"InfinityTwo"},"content":"        String[] requestParams \u003d new String[] {","isFullCredit":false},{"lineNumber":284,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_TARGET_USER, NotificationTargetUser.INSTRUCTOR.toString(),","isFullCredit":false},{"lineNumber":285,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.NOTIFICATION_IS_FETCHING_ALL, \"random-value\",","isFullCredit":false},{"lineNumber":286,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":287,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":288,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(requestParams);","isFullCredit":false},{"lineNumber":289,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":290,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":291,"author":{"gitId":"InfinityTwo"},"content":"    private void verifyNotificationEquals(NotificationData expected, NotificationData actual) {","isFullCredit":false},{"lineNumber":292,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getNotificationId(), actual.getNotificationId());","isFullCredit":false},{"lineNumber":293,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getStyle(), actual.getStyle());","isFullCredit":false},{"lineNumber":294,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getTargetUser(), actual.getTargetUser());","isFullCredit":false},{"lineNumber":295,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getTitle(), actual.getTitle());","isFullCredit":false},{"lineNumber":296,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getMessage(), actual.getMessage());","isFullCredit":false},{"lineNumber":297,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getStartTimestamp(), actual.getStartTimestamp());","isFullCredit":false},{"lineNumber":298,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(expected.getEndTimestamp(), actual.getEndTimestamp());","isFullCredit":false},{"lineNumber":299,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":300,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":301,"author":{"gitId":"InfinityTwo"},"content":"    private void verifyDoesNotContainNotifications(List\u003cNotificationData\u003e notifications, Set\u003cString\u003e readIds) {","isFullCredit":false},{"lineNumber":302,"author":{"gitId":"InfinityTwo"},"content":"        for (NotificationData n : notifications) {","isFullCredit":false},{"lineNumber":303,"author":{"gitId":"InfinityTwo"},"content":"            assertFalse(readIds.contains(n.getNotificationId()));","isFullCredit":false},{"lineNumber":304,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":305,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":306,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":306}},{"path":"src/test/java/teammates/sqlui/webapi/GetReadNotificationsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import java.util.ArrayList;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import java.util.stream.Collectors;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.ReadNotificationsData;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.GetReadNotificationsAction;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link GetReadNotificationsAction}.","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"public class GetReadNotificationsActionTest extends BaseActionTest\u003cGetReadNotificationsAction\u003e {","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"    /** Number of read notifications used for testing. */","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"    public static final int READ_NOTIFICATION_COUNT \u003d 2;","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATION_READ;","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"        return GET;","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_getReadNotificationsAsInstructor_shouldSucceed() {","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"        Instructor instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cNotification\u003e testNotifications \u003d new ArrayList\u003c\u003e();","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(instructor.getGoogleId());","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"        for (int i \u003d 0; i \u003c READ_NOTIFICATION_COUNT; i++) {","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"            testNotifications.add(getTypicalNotificationWithId());","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"        }","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cUUID\u003e testNotificationIds \u003d testNotifications.stream().map(Notification::getId).collect(Collectors.toList());","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.getReadNotificationsId(instructor.getGoogleId())).thenReturn(testNotificationIds);","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"        GetReadNotificationsAction action \u003d getAction();","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult jsonResult \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"        ReadNotificationsData output \u003d (ReadNotificationsData) jsonResult.getOutput();","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cString\u003e readNotificationsData \u003d output.getReadNotifications();","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"        readNotificationsData.forEach(notificationId -\u003e","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"                assertTrue(testNotificationIds.contains(UUID.fromString(notificationId))));","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(READ_NOTIFICATION_COUNT, readNotificationsData.size());","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":60}},{"path":"src/test/java/teammates/sqlui/webapi/GetTimeZonesActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.TimeZonesData;","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.GetTimeZonesAction;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link GetTimeZonesAction}.","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"public class GetTimeZonesActionTest extends BaseActionTest\u003cGetTimeZonesAction\u003e {","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.TIMEZONE;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"        return GET;","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_maintainers_canAccess() {","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"        loginAsMaintainer();","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_instructor_cannotAccess() {","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(Const.ParamsNames.INSTRUCTOR_ID);","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(Const.ParamsNames.STUDENT_ID);","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_unregistered_cannotAccess() {","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"        loginAsUnregistered(Const.ParamsNames.USER_ID);","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_normalCase_shouldSucceed() {","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"        GetTimeZonesAction a \u003d getAction();","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult r \u003d getJsonResult(a);","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"        TimeZonesData output \u003d (TimeZonesData) r.getOutput();","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"        // This test does not check the timezone database used is the latest","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"        // Only check that the version number is returned, and some sample values for timezone offset","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"        assertNotNull(output.getVersion());","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"        // There is a quirk in the ETC/GMT time zones due to the tzdb using POSIX-style signs in the zone names and the","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"        // output abbreviations. POSIX has positive signs west of Greenwich, while we are used to positive signs east","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"        // of Greenwich in practice. For example, TZ\u003d\u0027Etc/GMT+8\u0027 uses the abbreviation \"GMT+8\" and corresponds to 8","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"        // hours behind UTC (i.e. west of Greenwich) even though many people would expect it to mean 8 hours ahead of","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"        // UTC (i.e. east of Greenwich; like Singapore or China).","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"        // (adapted from tzdb table comments)","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(8 * 60 * 60, output.getOffsets().get(\"Etc/GMT-8\").intValue());","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(-5 * 60 * 60, output.getOffsets().get(\"Etc/GMT+5\").intValue());","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(11 * 60 * 60, output.getOffsets().get(\"Etc/GMT-11\").intValue());","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"        assertEquals(0, output.getOffsets().get(\"Etc/GMT+0\").intValue());","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":83}},{"path":"src/test/java/teammates/sqlui/webapi/GetUsageStatisticsActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import java.time.Duration;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"import java.time.Instant;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import java.time.temporal.ChronoUnit;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.GetUsageStatisticsAction;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link GetUsageStatisticsAction}.","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"public class GetUsageStatisticsActionTest extends BaseActionTest\u003cGetUsageStatisticsAction\u003e {","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"    private static final long START_TIME_FOR_FAIL_CASES \u003d Instant.now().minusSeconds(60).toEpochMilli();","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"    private static final long END_TIME_FOR_FAIL_CASES \u003d START_TIME_FOR_FAIL_CASES - 1000;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":"    protected String getActionUri() {","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.USAGE_STATISTICS;","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":"    protected String getRequestMethod() {","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":"        return GET;","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_admin_canAccess() {","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_maintainers_canAccess() {","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"        loginAsMaintainer();","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"        verifyCanAccess();","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_instructor_cannotAccess() {","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(Const.ParamsNames.INSTRUCTOR_ID);","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_student_cannotAccess() {","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"        loginAsStudent(Const.ParamsNames.STUDENT_ID);","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_loggedOut_cannotAccess() {","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"    void testAccessControl_unregistered_cannotAccess() {","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"        logoutUser();","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"        loginAsUnregistered(Const.ParamsNames.USER_ID);","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"        verifyCannotAccess();","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"    public void setUp() {","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"        loginAsAdmin();","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_success() {","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"        GetUsageStatisticsAction action \u003d getAction(","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, String.valueOf(START_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, String.valueOf(START_TIME_FOR_FAIL_CASES + 1000)","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"        );","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"        // For now, we stop at simply checking that the request is successful,","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"        // as we do not have means to reliably create test usage attributes data yet.","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"        getJsonResult(action);","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_endTimeBeforeStart_shouldFail() {","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"InfinityTwo"},"content":"        String[] paramsInvalid \u003d {","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, String.valueOf(START_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, String.valueOf(END_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(paramsInvalid);","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidSearchStartTime_shouldFail() {","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"InfinityTwo"},"content":"        String[] paramsInvalid \u003d {","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, \"abc\",","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, String.valueOf(END_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(paramsInvalid);","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_invalidSearchEndTime_shouldFail() {","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"InfinityTwo"},"content":"        String[] paramsInvalid \u003d {","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, String.valueOf(START_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, \" \",","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(paramsInvalid);","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_searchWindowTooLong_shouldFail() {","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"InfinityTwo"},"content":"        long daysExceedingSearchWindow \u003d 200L;","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"InfinityTwo"},"content":"        long startTime \u003d Instant.now().minus(daysExceedingSearchWindow, ChronoUnit.DAYS).toEpochMilli();","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"InfinityTwo"},"content":"        long millisExceedingSearchWindow \u003d Duration.ofDays(daysExceedingSearchWindow).toMillis();","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"InfinityTwo"},"content":"        String[] paramsInvalid \u003d {","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, String.valueOf(startTime),","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, String.valueOf(startTime + millisExceedingSearchWindow),","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(paramsInvalid);","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":124,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":125,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":126,"author":{"gitId":"InfinityTwo"},"content":"    void testExecute_endTimeAfterCurrentTime_shouldFail() {","isFullCredit":false},{"lineNumber":127,"author":{"gitId":"InfinityTwo"},"content":"        long millisExceedingNow \u003d Instant.now().plusMillis(1000).toEpochMilli();","isFullCredit":false},{"lineNumber":128,"author":{"gitId":"InfinityTwo"},"content":"        String[] paramsInvalid \u003d {","isFullCredit":false},{"lineNumber":129,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_STARTTIME, String.valueOf(START_TIME_FOR_FAIL_CASES),","isFullCredit":false},{"lineNumber":130,"author":{"gitId":"InfinityTwo"},"content":"                Const.ParamsNames.QUERY_LOGS_ENDTIME, String.valueOf(millisExceedingNow),","isFullCredit":false},{"lineNumber":131,"author":{"gitId":"InfinityTwo"},"content":"        };","isFullCredit":false},{"lineNumber":132,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpParameterFailure(paramsInvalid);","isFullCredit":false},{"lineNumber":133,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":134,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":135,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":135}},{"path":"src/test/java/teammates/sqlui/webapi/MarkNotificationAsReadActionTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"InfinityTwo"},"content":"package teammates.sqlui.webapi;","isFullCredit":false},{"lineNumber":2,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":3,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.ArgumentMatchers.any;","isFullCredit":false},{"lineNumber":4,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.ArgumentMatchers.eq;","isFullCredit":false},{"lineNumber":5,"author":{"gitId":"InfinityTwo"},"content":"import static org.mockito.Mockito.when;","isFullCredit":false},{"lineNumber":6,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":7,"author":{"gitId":"InfinityTwo"},"content":"import java.util.List;","isFullCredit":false},{"lineNumber":8,"author":{"gitId":"InfinityTwo"},"content":"import java.util.UUID;","isFullCredit":false},{"lineNumber":9,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":10,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.BeforeMethod;","isFullCredit":false},{"lineNumber":11,"author":{"gitId":"InfinityTwo"},"content":"import org.testng.annotations.Test;","isFullCredit":false},{"lineNumber":12,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":13,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.exception.EntityDoesNotExistException;","isFullCredit":false},{"lineNumber":14,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.exception.InvalidParametersException;","isFullCredit":false},{"lineNumber":15,"author":{"gitId":"InfinityTwo"},"content":"import teammates.common.util.Const;","isFullCredit":false},{"lineNumber":16,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Instructor;","isFullCredit":false},{"lineNumber":17,"author":{"gitId":"InfinityTwo"},"content":"import teammates.storage.sqlentity.Notification;","isFullCredit":false},{"lineNumber":18,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.output.ReadNotificationsData;","isFullCredit":false},{"lineNumber":19,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.request.InvalidHttpRequestBodyException;","isFullCredit":false},{"lineNumber":20,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.request.MarkNotificationAsReadRequest;","isFullCredit":false},{"lineNumber":21,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.EntityNotFoundException;","isFullCredit":false},{"lineNumber":22,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.JsonResult;","isFullCredit":false},{"lineNumber":23,"author":{"gitId":"InfinityTwo"},"content":"import teammates.ui.webapi.MarkNotificationAsReadAction;","isFullCredit":false},{"lineNumber":24,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":25,"author":{"gitId":"InfinityTwo"},"content":"/**","isFullCredit":false},{"lineNumber":26,"author":{"gitId":"InfinityTwo"},"content":" * SUT: {@link MarkNotificationAsReadAction}.","isFullCredit":false},{"lineNumber":27,"author":{"gitId":"InfinityTwo"},"content":" */","isFullCredit":false},{"lineNumber":28,"author":{"gitId":"InfinityTwo"},"content":"public class MarkNotificationAsReadActionTest extends BaseActionTest\u003cMarkNotificationAsReadAction\u003e {","isFullCredit":false},{"lineNumber":29,"author":{"gitId":"InfinityTwo"},"content":"    Instructor instructor;","isFullCredit":false},{"lineNumber":30,"author":{"gitId":"InfinityTwo"},"content":"    String instructorId;","isFullCredit":false},{"lineNumber":31,"author":{"gitId":"InfinityTwo"},"content":"    Notification testNotification;","isFullCredit":false},{"lineNumber":32,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":33,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":34,"author":{"gitId":"InfinityTwo"},"content":"    String getActionUri() {","isFullCredit":false},{"lineNumber":35,"author":{"gitId":"InfinityTwo"},"content":"        return Const.ResourceURIs.NOTIFICATION_READ;","isFullCredit":false},{"lineNumber":36,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":37,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":38,"author":{"gitId":"InfinityTwo"},"content":"    @Override","isFullCredit":false},{"lineNumber":39,"author":{"gitId":"InfinityTwo"},"content":"    String getRequestMethod() {","isFullCredit":false},{"lineNumber":40,"author":{"gitId":"InfinityTwo"},"content":"        return POST;","isFullCredit":false},{"lineNumber":41,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":42,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":43,"author":{"gitId":"InfinityTwo"},"content":"    @BeforeMethod","isFullCredit":false},{"lineNumber":44,"author":{"gitId":"InfinityTwo"},"content":"    void setUp() {","isFullCredit":false},{"lineNumber":45,"author":{"gitId":"InfinityTwo"},"content":"        instructor \u003d getTypicalInstructor();","isFullCredit":false},{"lineNumber":46,"author":{"gitId":"InfinityTwo"},"content":"        instructorId \u003d instructor.getGoogleId();","isFullCredit":false},{"lineNumber":47,"author":{"gitId":"InfinityTwo"},"content":"        testNotification \u003d getTypicalNotificationWithId();","isFullCredit":false},{"lineNumber":48,"author":{"gitId":"InfinityTwo"},"content":"        loginAsInstructor(instructorId);","isFullCredit":false},{"lineNumber":49,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":50,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":51,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":52,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_markNotificationAsRead_shouldSucceed() throws Exception {","isFullCredit":false},{"lineNumber":53,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.updateReadNotifications(","isFullCredit":false},{"lineNumber":54,"author":{"gitId":"InfinityTwo"},"content":"                instructorId,","isFullCredit":false},{"lineNumber":55,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getId(),","isFullCredit":false},{"lineNumber":56,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getEndTime()","isFullCredit":false},{"lineNumber":57,"author":{"gitId":"InfinityTwo"},"content":"        )).thenReturn(List.of(testNotification.getId()));","isFullCredit":false},{"lineNumber":58,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":59,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadRequest reqBody \u003d new MarkNotificationAsReadRequest(","isFullCredit":false},{"lineNumber":60,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getId().toString(), testNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":61,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":62,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadAction action \u003d getAction(reqBody);","isFullCredit":false},{"lineNumber":63,"author":{"gitId":"InfinityTwo"},"content":"        JsonResult actionOutput \u003d getJsonResult(action);","isFullCredit":false},{"lineNumber":64,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":65,"author":{"gitId":"InfinityTwo"},"content":"        ReadNotificationsData response \u003d (ReadNotificationsData) actionOutput.getOutput();","isFullCredit":false},{"lineNumber":66,"author":{"gitId":"InfinityTwo"},"content":"        List\u003cString\u003e readNotifications \u003d response.getReadNotifications();","isFullCredit":false},{"lineNumber":67,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":68,"author":{"gitId":"InfinityTwo"},"content":"        assertTrue(readNotifications.contains(testNotification.getId().toString()));","isFullCredit":false},{"lineNumber":69,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":70,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":71,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":72,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_markInvalidNotificationAsRead_shouldThrowIllegalArgumentError() {","isFullCredit":false},{"lineNumber":73,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadRequest reqBody \u003d","isFullCredit":false},{"lineNumber":74,"author":{"gitId":"InfinityTwo"},"content":"                new MarkNotificationAsReadRequest(\"invalid id\", testNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":75,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":76,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadAction action \u003d getAction(reqBody);","isFullCredit":false},{"lineNumber":77,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":78,"author":{"gitId":"InfinityTwo"},"content":"        assertThrows(IllegalArgumentException.class, () -\u003e action.execute());","isFullCredit":false},{"lineNumber":79,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":80,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":81,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":82,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_markNonExistentNotificationAsRead_shouldFail() throws Exception {","isFullCredit":false},{"lineNumber":83,"author":{"gitId":"InfinityTwo"},"content":"        UUID nonExistentNotificationId \u003d UUID.randomUUID();","isFullCredit":false},{"lineNumber":84,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":85,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadRequest reqBody \u003d","isFullCredit":false},{"lineNumber":86,"author":{"gitId":"InfinityTwo"},"content":"                new MarkNotificationAsReadRequest(","isFullCredit":false},{"lineNumber":87,"author":{"gitId":"InfinityTwo"},"content":"                        nonExistentNotificationId.toString(),","isFullCredit":false},{"lineNumber":88,"author":{"gitId":"InfinityTwo"},"content":"                        testNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":89,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":90,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.updateReadNotifications(","isFullCredit":false},{"lineNumber":91,"author":{"gitId":"InfinityTwo"},"content":"                any(),","isFullCredit":false},{"lineNumber":92,"author":{"gitId":"InfinityTwo"},"content":"                eq(nonExistentNotificationId),","isFullCredit":false},{"lineNumber":93,"author":{"gitId":"InfinityTwo"},"content":"                eq(testNotification.getEndTime()))).thenThrow(new EntityDoesNotExistException(\"\"));","isFullCredit":false},{"lineNumber":94,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":95,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadAction action \u003d getAction(reqBody);","isFullCredit":false},{"lineNumber":96,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":97,"author":{"gitId":"InfinityTwo"},"content":"        assertThrows(EntityNotFoundException.class, () -\u003e action.execute());","isFullCredit":false},{"lineNumber":98,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":99,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":100,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":101,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_notificationEndTimeIsZero_shouldFail() {","isFullCredit":false},{"lineNumber":102,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadRequest reqBody \u003d","isFullCredit":false},{"lineNumber":103,"author":{"gitId":"InfinityTwo"},"content":"                new MarkNotificationAsReadRequest(testNotification.getId().toString(), 0L);","isFullCredit":false},{"lineNumber":104,"author":{"gitId":"InfinityTwo"},"content":"        verifyHttpRequestBodyFailure(reqBody);","isFullCredit":false},{"lineNumber":105,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":106,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":107,"author":{"gitId":"InfinityTwo"},"content":"    @Test","isFullCredit":false},{"lineNumber":108,"author":{"gitId":"InfinityTwo"},"content":"    protected void testExecute_markExpiredNotificationAsRead_shouldFail() throws Exception {","isFullCredit":false},{"lineNumber":109,"author":{"gitId":"InfinityTwo"},"content":"        when(mockLogic.updateReadNotifications(","isFullCredit":false},{"lineNumber":110,"author":{"gitId":"InfinityTwo"},"content":"                instructorId,","isFullCredit":false},{"lineNumber":111,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getId(),","isFullCredit":false},{"lineNumber":112,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getEndTime()","isFullCredit":false},{"lineNumber":113,"author":{"gitId":"InfinityTwo"},"content":"        )).thenThrow(new InvalidParametersException(\"Trying to mark an expired notification as read.\"));","isFullCredit":false},{"lineNumber":114,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":115,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadRequest reqBody \u003d new MarkNotificationAsReadRequest(","isFullCredit":false},{"lineNumber":116,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getId().toString(),","isFullCredit":false},{"lineNumber":117,"author":{"gitId":"InfinityTwo"},"content":"                testNotification.getEndTime().toEpochMilli());","isFullCredit":false},{"lineNumber":118,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":119,"author":{"gitId":"InfinityTwo"},"content":"        MarkNotificationAsReadAction action \u003d getAction(reqBody);","isFullCredit":false},{"lineNumber":120,"author":{"gitId":"InfinityTwo"},"content":"","isFullCredit":false},{"lineNumber":121,"author":{"gitId":"InfinityTwo"},"content":"        assertThrows(InvalidHttpRequestBodyException.class, () -\u003e action.execute());","isFullCredit":false},{"lineNumber":122,"author":{"gitId":"InfinityTwo"},"content":"    }","isFullCredit":false},{"lineNumber":123,"author":{"gitId":"InfinityTwo"},"content":"}","isFullCredit":false}],"authorContributionMap":{"InfinityTwo":123}}]
